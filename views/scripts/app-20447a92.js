"use strict";function msgCalendar(e,a,t,i){function n(n,o,s){function r(){return"dashboard-page"===n.placement}function l(i){function n(a){var i;i=e.Year?e.Year._id:e.Season._id;var n=e.Month._id,o="00"===n;return a=t.prepFilters(a),o?a.filters.Date={gte:i+"0101",lte:i+"1231"}:a.filters.Date={gte:i+n+"01",lte:moment(i+n+"01","YYYYMMDD").endOf("month").format("YYYYMMDD")},a}var o;switch(i){case"productions":o=a.queryCalendar;break;case"productionsSummary":o=a.queryCalendarTotal;break;case"bookings":o=a.queryBookingsCalendar;break;case"sports":o=a.querySportsCalendar;break;default:o=a.queryCalendar}return r()?o.filters.Date={gte:moment().startOf("week").format("YYYYMMDD"),lte:moment().startOf("week").add(13,"days").format("YYYYMMDD")}:n(o),o}function d(){function e(e){return{DiscountToFace:null,EndDate:e.endOf("week").format("YYYYMMDD"),Performance:null,PerformanceCode:null,Revenue:null,RevenuePerCap:null,SellThrough:null,Sold:null,StartDate:e.startOf("week").format("YYYYMMDD"),week:e.format("WW")}}function a(e,a,t){return(e[t]*e.count+a[t]*a.count)/(e.count+a.count)}var t=l(n.module+"Summary");i.getWallaceData({params:{q:JSON.stringify(t)}}).then(function(t){if(t.data.length>2&&"dashboard-page"===n.placement){var i=_.find(t.data,{week:52}),o=_.find(t.data,{week:0}),s=_.clone(i);s.DiscountToFace=a(i,o,"DiscountToFace"),s.EndDate=o.EndDate,s.Performance=a(i,o,"Performance"),s.Revenue+=o.Revenue,s.RevenuePerCap=a(i,o,"RevenuePerCap"),s.SellThrough=a(i,o,"SellThrough"),s.Sold+=o.Sold,t.data=_.without(t.data,i,o),t.data.push(s)}var l=t.data;if(_.forEach(l,function(e){e.Performance>1?e.PerformanceCode="perf-hi":e.Performance>.74?e.PerformanceCode="perf-on":e.PerformanceCode="perf-lo",e.RevenuePerCap=e.Revenue/e.Sold}),r()&&"productions"===n.module&&(0===f&&(l=[e(moment()),e(moment().add(1,"week"))]),1===f)){var d=moment(l[0].StartDate,"YYYYMMDD").startOf("week");d===moment().startOf("week")?l.push(e(moment().add(1,"week"))):l.unshift(e(moment()))}n.summaries=_.sortBy(l,function(e){var a=new Date(e.EndDate.slice(0,4),e.EndDate.slice(4,6),e.EndDate.slice(-2));return a})})}function c(){var a=l(n.module);i.getWallaceData({params:{q:JSON.stringify(a)}}).then(function(a){var t=[];_.forEach(_.groupBy(a.data,"Date"),function(e){t.push(u(e))}),n.calendar=v(t),n.calendar[0]?(e.calendarStart=n.calendar[0][0].date.format("DD MMM"),e.calendarEnd=n.calendar.slice(-1)[0].slice(-1)[0].date.format("DD MMM")):(e.calendarStart="",e.calendarEnd="")})}function u(e){var a=moment(e[0].Date,"YYYYMMDD"),t={};t.date=a,t.season=e[0].Season,t.dayOfWeek=moment(a).format("ddd"),t.dayOfMonth=moment(a).format("D"),t.startOfWeek=moment(a).startOf("week").format("YYYY-MM-DD");var i=[];return _.forEach(e,function(e){i.push(p(e))}),t.events=_.sortBy(i,"Meridiem"),t}function p(e){var a=e;if("productions"===n.module){a.PerformanceCode=e.PerformanceCategory.replace(/\s+/g,"-").toLowerCase(),a.TimeSlotOriginal=e.TimeSlot,a.TimeSlot=e.TimeSlot.substr(0,e.TimeSlot.lastIndexOf(" "))+" "+e.TimeSlot.substr(e.TimeSlot.lastIndexOf("M")-1,e.TimeSlot.length),a.SellThrough=e.SellThrough;var t;t="PM"===e.TimeSlot.split(" ")[1]?12+parseInt(e.TimeSlot.split(" ")[0]):parseInt(e.TimeSlot.split(" ")[0]),a.Meridiem=t}return"bookings"===n.module&&(e.Performance&&(a.Performance=e.Performance.replace(/\s+/g,"-").toLowerCase(),a.PerformanceCategory=a.Performance),a.EventOriginal=e.Event,a.Event=e.EventName,a.VenueCode=e.Venue.charAt(0),a.TimeSlot=e.TimeSlot,a.Meridiem=e.TimeSlot.slice(-2)),"sports"===n.module&&(a.Team=e.Team,a.Venue="MSG Arena",a.Opponent=e.Opponent,a.Result=e.Result,a.PerformanceCategory=e.PerformanceCategory.replace(/\s+/g,"-").toLowerCase(),a.Time=e.Time),a}function v(e){function a(e){return{date:e.startOf("week"),dayOfWeek:e.startOf("week").format("ddd"),dayOfMonth:e.startOf("week").format("D"),season:e.startOf("week").format("YYYY"),events:[],startOfWeek:e.startOf("week").format("YYYY-MM-DD")}}var t=_.groupBy(e,"startOfWeek"),i=_.toArray(t);if(f=i.length,r()&&(0===f&&(e=[a(moment()),a(moment().add(1,"week"))]),1===f&&(e[0].startOfWeek===moment().startOf("week").format("YYYY-MM-DD")?e.push(a(moment().add(1,"week"))):e.unshift(a(moment())))),"sports"===n.module&&4>f&&f>0){var o=i[0][f-1].date;e.push(a(moment(o).add(1,"weeks"))),e.push(a(moment(o).add(2,"weeks"))),e.push(a(moment(o).add(3,"weeks")))}var s=[];return _.forEach(_.groupBy(e,"startOfWeek"),function(e){if(e.length<7){var a=[];_.times(7,function(t){var i=moment(e[0].startOfWeek,"YYYY-MM-DD").add(t,"days"),n=_.find(e,function(e){return e.date.format("YYYY-MM-DD")===i.format("YYYY-MM-DD")});n||a.push({date:i,dayOfMonth:i.format("D"),dayOfWeek:i.format("ddd"),season:e[0].season,events:[],startOfWeek:e[0].startOfWeek})}),e=_.sortBy(e.concat(a),"date")}s.push(e)}),s}n.$on("init",function(e,a){c(),"productions"===n.module&&d()}),n.detailDay={},n.detailDay.show="none";var f;n.showTileDetail=function(e,a,t){n.detailDay.show="block",n.detailDay=e,"productions"===n.module&&(n.detailDay.xPosition=a.delegateTarget.offsetLeft,n.detailDay.yPosition=a.delegateTarget.offsetParent.offsetTop),"bookings"===n.module&&(n.detailDay.xPosition=a.target.offsetLeft,n.detailDay.yPosition=a.target.offsetTop,n.detailDay.date=t.date.format("ddd, DD MMM YYYY")),"sports"===n.module&&(n.detailDay.xPosition=a.target.offsetLeft,n.detailDay.yPosition=a.target.offsetTop,n.detailDay.date=t.date.format("ddd, DD MMM YYYY"))},n.closeTileDetail=function(e){e.stopImmediatePropagation(),n.detailDay.show="none"},n.goToDetail=function(a){e.eventDetail=a,t.GoToPage("bookingsEventDetail")},n.goToFilteredCalendar=function(a,i){var n=a.Date.slice(4,6)+"/"+a.Date.slice(6,8)+"/"+a.Date.slice(0,4);e.selectCustomRange(n),e.stickyCalendar=[],a.Season&&e.stickyCalendar.push({id:"Season",val:a.Season}),a.TimeSlotOriginal&&e.stickyCalendar.push({id:"TimeSlot",val:a.TimeSlotOriginal}),t.GoToPage(i)}}var o={link:n,scope:{module:"@module",placement:"@placement"},templateUrl:function(e,a){return"views/"+a.module+"/calendar-template.html"},restrict:"E"};return o}angular.module("app").factory("sportsTicketsSvc",["$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n){var o={};return o.initRevenue=function(e){var o=i.prepFilters(t.sports.ticketRevenue);a.all([n.getWallaceData({params:{q:JSON.stringify(o)}})]).then(function(a){i.getLastUpdated(a[0].data);var t=["actual","budget","prior"];_.each(a[0].data,function(a,i){a.total=0;for(var n in a)if(a.hasOwnProperty(n)&&"Type"!==n&&"total"!==n&&"LastUpdate"!==n){a.total+=a[n];var o=_.where(e.breakdown,{id:n});o.length>0&&(o[0][t[i]]=a[n])}e.total[0][t[i]]=a.total}),setTimeout(function(){$('[data-toggle="popover"]').popover()},300)})},o.initSoldMix=function(e){var o=i.prepFilters(t.sports.ticketAllocated),s=i.prepFilters(t.sports.ticketSold);a.all([n.getWallaceData({params:{q:JSON.stringify(o)}}),n.getWallaceData({params:{q:JSON.stringify(s)}})]).then(function(a){e.allocated=[i.checkUndefined(a[0].data[0],"Season_Allocated"),i.checkUndefined(a[0].data[0],"Individual_Allocated"),i.checkUndefined(a[0].data[0],"Group_Allocated"),i.checkUndefined(a[0].data[0],"Lounge_Allocated"),i.checkUndefined(a[0].data[0],"Lounge_Allocated"),i.checkUndefined(a[0].data[0],"Suite_Allocated")],e.sold=[i.checkUndefined(a[1].data[0],"Season_Sold"),i.checkUndefined(a[1].data[0],"Individual_Sold"),i.checkUndefined(a[1].data[0],"Group_Sold"),i.checkUndefined(a[1].data[0],"Lounge_Sold"),i.checkUndefined(a[1].data[0],"Lounge_Sold"),i.checkUndefined(a[1].data[0],"Suite_Sold")],e.available=_.map(e.allocated,function(a,t){return a-e.sold[t]}),e.soldColors=["#336080","#f68428","#4d4d4d","#50909a","#0068b3"]})},o.initGeneric=function(e,s,r,l){var d=i.prepFilters(t.sports[s+"Revenue"]),c=[];if(c.push(n.getWallaceData({params:{q:JSON.stringify(d)}})),"suite"!==s){var u=i.prepFilters(t.sports[s+"Sold"]),p=i.prepFilters(t.sports[s+"RevenuePerCap"]);c.push(n.getWallaceData({params:{q:JSON.stringify(u)}})),c.push(n.getWallaceData({params:{q:JSON.stringify(p)}}))}a.all(c).then(function(a){_.each(e,function(e,t){var i=_.where(a[t].data,{Type:"Actual"}),n=_.where(a[t].data,{Type:"Budget"});o.assignTypes(e,"actual",i,r,l),o.assignTypes(e,"budget",n,r,l)})})},o.assignTypes=function(e,a,t,i,n){t.length>0&&(e.total[0][a]=t[0][i[0]+e.data+n[0]],_.each(e.breakdown,function(o,s){o[a]=t[0][i[s+1]+e.data+n[s+1]]}))},o.initSeasonMix=function(e){var o=i.prepFilters(t.sports.seasonMix);a.all([n.getWallaceData({params:{q:JSON.stringify(o)}})]).then(function(a){_.each(e,function(e){e.data=[];var t=_.where(a[0].data,{Type:e.type});e.data.push(t[0].Season_Sold_Renewal),e.data.push(t[0].Season_Sold_New),e.data.push(t[0].Season_Sold_Partial),e.data.push(t[0].Season_Sold_Hold),e.data.push(t[0].Season_Allocated_Total-t[0].Season_Sold_Total),e.colors=["#336080","#4d4d4d","#50909a","#0068b3","#84ccac"]})})},o.initLounge=function(e){var o=i.prepFilters(t.sports.lounge);a.all([n.getWallaceData({params:{q:JSON.stringify(o)}})]).then(function(a){_.each(e,function(e){var t=_.where(a[0].data,{Type:"Actual"}),i=_.where(a[0].data,{Type:"Budget"});e.breakdown.push(t[0][e.data]),e.breakdown.push(i[0][e.data]),e.setMax&&(e.max=i[0].Lounge_Allocated)})})},o.initUnlicensed=function(e){e.data=[];var o=i.prepFilters(t.sports.unlicensedSuites);a.all([n.getWallaceData({params:{q:JSON.stringify(o)}})]).then(function(a){e.data.push(a[0].data[0].Suites_Sold_Single),e.data.push(a[0].data[0].Suites_Sold_SuitePass),e.data.push(a[0].data[0].Suites_Sold_Budget),e.data.push(a[0].data[0].Suites_Sold_Available-a[0].data[0].Suites_Sold_Single-a[0].data[0].Suites_Sold_SuitePass-a[0].data[0].Suites_Sold_Budget)})},o.initAvgSuite=function(e){var o=i.prepFilters(t.sports.averageSuite);a.all([n.getWallaceData({params:{q:JSON.stringify(o)}})]).then(function(a){var t=_.where(a[0].data,{Type:"Actual"}),i=_.where(a[0].data,{Type:"Budget"}),n=0,o=0;0!==t[0].Suites_Sold&&(n=t[0].Suites_Revenue/t[0].Suites_Sold),0!==i[0].Suites_Sold&&(o=i[0].Suites_Revenue/i[0].Suites_Sold),e.data=[n,o]})},o.initSuiteMix=function(e){e.data=[];var o=i.prepFilters(t.sports.suiteMix);a.all([n.getWallaceData({params:{q:JSON.stringify(o)}})]).then(function(a){e.data.push(a[0].data[0].Suites_Sold_Licenses_Renewal),e.data.push(a[0].data[0].Suites_Sold_Licenses_New),e.data.push(a[0].data[0].Suites_Sold_Licenses_Total-a[0].data[0].Suites_Sold_Licenses_Renewal-a[0].data[0].Suites_Sold_Licenses_New)})},o}]),angular.module("app").factory("sportsSvc",["$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n){var o={};return o.init=function(e){var o=i.prepFilters(t.sports.revenue),s=_.cloneDeep(o),r=_.cloneDeep(o);s.filters.Type="Budget",r.filters.Type="PriorYear",a.all([n.getWallaceData({params:{q:JSON.stringify(o)}}),n.getWallaceData({params:{q:JSON.stringify(s)}}),n.getWallaceData({params:{q:JSON.stringify(r)}})]).then(function(a){i.getLastUpdated(a[0].data),e.allSports={total:[{name:"",actual:0,budget:0,prior:0}],format:"#"},e.suites={total:[{name:"",actual:0,budget:0,prior:0}],format:"#"},e.sportGraphs=[{breakdown:[0,0,0],format:"#",img:"knicks_logo.png",team:"Knicks"},{breakdown:[0,0,0],format:"#",img:"rangers_logo.png",team:"Rangers"},{breakdown:[0,0,0],format:"#",img:"liberty_logo.png",team:"Liberty"},{breakdown:[0,0,0],format:"#",img:"westchester-knicks_logo.png",team:"Westchester Knicks"}];var t=["actual","budget","prior"];_.each(a,function(a,i){_.each(a.data,function(a){e.allSports.total[0][t[i]]+=a.TicketRevenue,e.suites.total[0][t[i]]+=a.SuiteRevenue;var n=_.where(e.sportGraphs,{team:a.Team});n.length>0&&(n[0].breakdown[i]=a.TicketRevenue,0===i&&(n[0].win=a.Wins,n[0].loss=a.Losses))})})})},o}]),angular.module("app").factory("bookingsTicketsSponsorshipsSvc",["$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n){var o={};return o.init=function(e){var a=i.prepFilters(t.bookings.ticketSponsorships),o=n.getWallaceData({params:{q:JSON.stringify(a)}});return o.then(function(a){i.getLastUpdated(a.data);var t=[{name:"pieDataActual",data:"Revenue"},{name:"pieDataBudget",data:"Budget"},{name:"pieDataPrior",data:"PriorYear"}],n=[{name:"Contracted",data:[]},{name:"New Business",data:[]},{name:"Renewal",data:[]}],o=[{name:"Revenue",data:0},{name:"Budget",data:0},{name:"PriorYear",data:0}];e.chartRevenue={total:[],breakdown:[]};var s=_.sortBy(a.data,function(e){return e.Revenue});s.length>5&&(s=s.slice(s.length-5,s.length)),_.each(s,function(a){e.chartRevenue.breakdown.push({name:a.Sponsor,actual:a.Revenue,budget:a.Budget,prior:a.PriorYear})}),_.each(n,function(e){e.data=_.where(a.data,{SponsorType:e.name})}),_.each(t,function(a){e[a.name]=[],_.each(n,function(t){e[a.name].push(_.reduce(t.data,function(e,t){return e+i.checkUndefined(t[a.data])},0))})}),_.each(o,function(e){e.data=_.reduce(a.data,function(a,t){return a+i.checkUndefined(t[e.name])},0)}),e.chartRevenue.total.push({name:"Total",actual:o[0].data,budget:o[1].data,prior:o[2].data}),e.chartSponsors=[a.data.length],e.chartDeal=[o[1].data/a.data.length,o[1].data/a.data.length,o[2].data/a.data.length],setTimeout(function(){$('[data-toggle="popover"]').popover()},300)}),o},o}]),angular.module("app").factory("bookingsTicketsBothSvc",["$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n){var o={};return o.init=function(e,a){var s=n.getWallaceData({params:{q:JSON.stringify(i.prepFilters(t.bookings.ticketBoth))}});return s.then(function(t){i.getLastUpdated(t.data),e.data=t.data,o.setupHeatmap(e.data,a)}),s},o.setupHeatmap=function(e,a){var t=[],i=[],n=0,s=0,r=0,l=_.chain(e).pluck("EventType").uniq().sort().value(),d=_.chain(e).pluck("Venue").uniq().sort().value();_.each(l,function(a,l){s=0,r=0,_.each(d,function(n,d){var c={};c.y=l+1,c.x=d+1,c.yVal=a,c.xVal=n,c.value=o.getValue(e,a,n),t.push(c),i[d]?i[d]+=c.value:i.push(c.value),r+=c.value,s++});var c={};c.y=l+1,c.x=s+1,c.yVal=a,c.xVal="all",c.value=o.sumOrAvg(r,s),c.total=!0,t.push(c),n++}),s=0,r=0,_.each(d,function(e,a){var l={};l.y=n+1,l.x=a+1,l.yVal="all",l.xVal=e,l.value=o.sumOrAvg(i[a],n),l.total=!0,t.push(l),r+=l.value,s++});var c={};return c.y=n+1,c.x=s+1,c.yVal="all",c.xVal="all",c.value=o.sumOrAvg(r,s),c.total=!0,t.push(c),l.push("Totals"),d.push("Totals"),_.each(l,function(e,a){e&&"s"!==e.slice(-1)&&(l[a]=e+"s")}),a.ycats=l,a.xcats=d,a.chartData=t,a},o.sumOrAvg=function(a,t){return"avg"===e.heatmap.math?a/t:a},o.getValue=function(a,t,i){var n=_.where(a,function(e){return e.EventType===t&&e.Venue===i}),o=0;switch(n.length>0&&e.heatmap.attr&&(o=_.pluck(n,e.heatmap.attr).reduce(function(e,a){return e+a})),e.heatmap.math){case"count":return n.length;case"sum":return o;case"avg":return 0===o?0:o/n.length}},o}]),angular.module("app").factory("bookingsEventDetailSvc",["$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n){function o(e,a){return e&&a?e/a:0}var s={};return s.init=function(e,s,r){var l,d=t.eventDetails.ticket,c=t.eventDetails.operations,u=t.eventDetails.sponsors;return console.log("event",e),d.filters.Event=e,c.filters.Event=e,u.filters.Event=e,l=a.all([n.getWallaceData({params:{q:JSON.stringify(d)}}),n.getWallaceData({params:{q:JSON.stringify(c)}}),n.getWallaceData({params:{q:JSON.stringify(u)}})]),l.then(function(e){i.getLastUpdated(e[0].data);var a=e[0].data,t=e[1].data,n=e[2].data,l={},d={};l.ticket=_.where(a,function(e){return"A"===e.Type&&"DARK"!==e.Performance})[0],d.ticket=_.where(a,function(e){return"C"===e.Type&&"DARK"!==e.Performance})[0],l.operations=_.where(t,function(e){return"A"===e.Type&&"DARK"!==e.Performance})[0],d.operations=_.where(t,function(e){return"C"===e.Type&&"DARK"!==e.Performance})[0],l.ticket=l.ticket?l.ticket:{},d.ticket=d.ticket?d.ticket:{},l.operations=l.operations?l.operations:{},d.operations=d.operations?d.operations:{},s.count=d.ticket.count,s.countText="Performances",1===s.count&&(s.countText="Performance"),s.SellThrough=0,l.ticket.Capacity&&(s.SellThrough=l.ticket.Sold/l.ticket.Capacity),s.Revenue=l.ticket["Total Revenue"],s.StartDate=d.ticket.StartDate,s.EndDate=d.ticket.EndDate;var c=d;moment().diff(moment(s.EndDate,"YYYYMMDD"),"days")>0&&(c=l),s.ProjectedContribution=c.ticket.ProjectedContribution,s.ProjectedContributionPerTicket=0,c.ticket.Sold&&(s.ProjectedContributionPerTicket=c.ticket.ProjectedContribution/c.ticket.Sold),_.each(r,function(a){if("sponsors"===a.table)e[2].data&&e[2].data.length>0&&(a.breakdown.push(n[0].Revenue),a.breakdown.push(n[0].Budget));else switch(a.data){case"SellThrough":a.breakdown.push(o(l.ticket.Sold,l.ticket.Capacity)),a.breakdown.push(o(d.ticket.Sold,d.ticket.Capacity));break;case"TicketYield":a.breakdown.push(o(l.ticket.TotalSales,l.ticket.Sold)),a.breakdown.push(o(d.ticket.TotalSales,d.ticket.Sold));break;case"FoodBeveragePerCap":_.isObject(l.operations)&&_.isObject(d.operations)&&(a.breakdown.push(o(l.operations.FoodBeverage,l.ticket.Sold)),a.breakdown.push(o(d.operations.FoodBeverage,d.ticket.Sold)));break;case"MerchandisePerCap":_.isObject(l.operations)&&_.isObject(d.operations)&&(a.breakdown.push(o(l.operations.Merchandise,l.ticket.Sold)),a.breakdown.push(o(d.operations.Merchandise,d.ticket.Sold)));break;default:l[a.table]?a.breakdown.push(l[a.table][a.data]):a.breakdown.push(0),d[a.table]?a.breakdown.push(d[a.table][a.data]):a.breakdown.push(0)}}),setTimeout(function(){$('[data-toggle="popover"]').popover()},300)}),l},s}]),angular.module("app").factory("bookingsSvc",["$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n){var o={};return o.getDarkDays=function(e){var a=i.prepFilters(t.bookings.operations);n.getWallaceData({params:{q:JSON.stringify(a)}}).then(function(t){var i=o.getDays(a.filters.Date);e.breakdown=[],_.each(t.data,function(a){e.breakdown.push({name:a.Venue,actual:i-a.Actual})})})},o.getDays=function(e){return e?(e.lt||(e.lt=e.gt.slice(0,4)+"1231"),e.gt||(e.gt=e.lt.slice(0,4)+"0101"),moment(e.lt,"YYYYMMDD",!0).diff(moment(e.gt,"YYYYMMDD",!0),"days")):365},o}]),angular.module("app").controller("bookingsTicketsVenueCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,e.charts=[{title:"Total MSG Revenue",type:"column",data:"Revenue",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[],info:"Total MSG Revenue includes MSG’s portion of ticket sales revenue, license fees, facility fees, and event-specific sponsorships. It does not include food, beverage, or merchandise revenue."},{title:"Total Tickets Sold",type:"column",data:"Sold",unit:"k",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Ticket Yield",type:"column",data:"RevenuePerCap",unit:"$",format:"#",decimal:2,total:[{name:"Total",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"The total revenue divided by the number of tickets sold – the average revenue per ticket"},{title:"Average Discount off of Budgeted List Price",type:"column",data:"DiscountToFace",unit:"%",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"The percent difference between the actual ticket yield and budgeted ticket yield"}],a.prepHeader("Bookings-TicketSales","bookings",["EventName","Year","Range"],[{name:"MSG Live",url:"bookings"},{name:"Ticket Sales"}]),e.$on("init",function(a,t){n.getData([e.charts],i.bookings.ticketVenue,"Venue")})}]),angular.module("app").controller("bookingsTicketsSponsorshipsCtrl",["$scope","$rootScope","$q","constants","common","bookingsTicketsSponsorshipsSvc",function(e,a,t,i,n,o){e.common=n,e.mixData=[{State:"Actual"},{State:"Previous Year"},{State:"Budget"}],e.mixFormat="#",a.prepHeader("Bookings-TicketSales","bookings",["Year","Range"],[{name:"MSG Live",url:"bookings"},{name:"Ticket Sales"}]),e.sponsor={},e.$on("init",function(a,t){o.init(e.sponsor)})}]),angular.module("app").controller("bookingsTicketsEventCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,e.charts=[{title:"Total MSG Revenue",type:"column",data:"Revenue",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[],info:"Total MSG Revenue includes MSG’s portion of ticket sales revenue, license fees, facility fees, and event-specific sponsorships. It does not include food, beverage, or merchandise revenue."},{title:"Total Tickets Sold",type:"column",data:"Sold",unit:"k",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Ticket Yield",type:"column",data:"RevenuePerCap",unit:"$",format:"#",decimal:2,total:[{name:"Total",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"The total revenue divided by the number of tickets sold – the average revenue per ticket"},{title:"Average Ticket Price Relative to Face Value",type:"column",data:"DiscountToFace",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"The percent difference between the actual ticket yield and budgeted ticket yield"}],a.prepHeader("Bookings-TicketSales","bookings",["Venue","Year","Range"],[{name:"MSG Live",url:"bookings"},{name:"Ticket Sales"}]),e.$on("init",function(a,t){n.getData([e.charts],i.bookings.ticketEvent,"EventType")})}]),angular.module("app").controller("bookingsTicketsBothCtrl",["$scope","$rootScope","$q","constants","common","bookingsTicketsBothSvc",function(e,a,t,i,n,o){e.common=n,e.count=0,e.heat={},e.details={},a.prepHeader("Bookings-TicketSales","bookings heatmap",["Year","Range"],[{name:"MSG Live",url:"bookings"},{name:"Ticket Sales"}]),e.setHeight=function(a){a-=70,e.height=a+"px"},e.getData=function(e){return a.heatmap.attr?n.format(e[a.heatmap.attr],a.heatmap.format):1},e.goToDetail=function(e){a.eventDetail=e,a.eventDetail.EventOriginal=e.Event,a.eventDetail.Event=e.EventName,a.eventDetail.date=moment(e.Date,"YYYYMMDD").format("ddd, DD MMM YYYY"),a.eventDetail.heatmap=!0,n.GoToPage("bookingsEventDetail")},e.select=function(a){var t="All Events",i="All Venues",n=e.details.data;"all"!==a.yVal&&"all"!==a.xVal?(n=_.where(e.details.data,function(e){return e.EventType===a.yVal&&e.Venue===a.xVal}),t=a.yVal,i=a.xVal):"all"===a.yVal&&"all"!==a.xVal?(n=_.where(e.details.data,function(e){return e.Venue===a.xVal}),i=a.xVal):"all"!==a.yVal&&"all"===a.xVal&&(n=_.where(e.details.data,function(e){return e.EventType===a.yVal}),t=a.yVal),"s"!==t.slice(-1)&&(t+="s"),e.color=a.color,e.count=a.value,e.eventType=t,e.venue=i,e.events=n,e.$$phase||e.$apply()},e.$on("heatmapHeight",function(a,t){e.setHeight(t)}),e.$on("heatmapSelect",function(a,t){e.select(t)}),e.$on("heatmapTypeChange",function(a,t){o.setupHeatmap(e.details,e.heat)}),e.$on("init",function(a,t){o.init(e.details,e.heat)})}]),angular.module("app").controller("bookingsOperationsVenueCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,e.charts=[{title:"Food & Beverage Total Revenue",type:"column",data:"FoodBeverage",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Food & Beverage Revenue per Cap",type:"column",decimal:2,data:"FoodBeveragePerCap",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[]},{title:"Merchandise Total Revenue",type:"column",data:"Merchandise",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Merchandise Revenue per Cap",type:"column",decimal:2,data:"MerchandisePerCap",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[]}],a.prepHeader("Bookings-Operations","bookings",["EventName","Year","Range"],[{name:"MSG Live",url:"bookings"},{name:"Operations"}]),e.$on("init",function(a,t){n.getData([e.charts],i.bookings.operationsVenue,"Venue")})}]),angular.module("app").controller("bookingsOperationsSummaryCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,e.count=0,e.charts=[{title:"Ancillary Revenue",query:"operationsSummaryAncillary",graphs:[{title:"Food & Beverage Total Revenue",type:"bar",data:"FoodBeverage",unit:"$",format:"#",breakdown:[]},{title:"Food & Beverage Revenue per Cap",type:"bar",decimal:2,data:"FoodBeveragePerCap",unit:"$",format:"#",breakdown:[],info:"The total food and beverage revenue divided by the number of attendees"},{title:"Merchandise Total Revenue",type:"bar",data:"Merchandise",unit:"$",format:"#",breakdown:[]},{title:"Merchandise Revenue per Cap",type:"bar",decimal:2,data:"MerchandisePerCap",unit:"$",format:"#",breakdown:[],info:"The total merchandise revenue divided by the number of attendees"}]},{title:"Staffing Levels",query:"operationsSummaryStaffing",graphs:[{title:"Front of House Labor Cost per Attendee",type:"bar",data:"LaborCost",unit:"$",format:"#",breakdown:[],info:"Labor cost includes costs from the following categories: food and beverage, merchandise, ticket operations (box office), building services (janitorial), security, and guest relations (ticket takers)"},{title:"Front of House Staff per Attendee",type:"bar",data:"Staffing",unit:"k",format:"#",breakdown:[],info:"Staff totals include the number of staff staff from the following categories: food and beverage, merchandise, ticket operations (box office), building services (janitorial), security, and guest relations (ticket takers)"}]},{title:"Guest Satisfaction",query:"operationsSummaryGuest",graphs:[{data:"GuestSatisfaction",type:"bar",unit:"$",format:"#",temp:!0}]}],a.prepHeader("Bookings-Operations","bookings",["Venue","EventName","Year","Range"],[{name:"MSG Live",url:"bookings"},{name:"Operations"}]),e.$on("init",function(a,t){n.getData([e.charts[0].graphs],i.bookings.operationsSummaryAncillary),n.getData([e.charts[1].graphs],i.bookings.operationsSummaryStaffing),n.getData([e.charts[2].graphs],i.bookings.operationsSummaryGuest,"Venue"),n.getData([e.charts[1].graphs],i.bookings.operationsSummaryStaffing)})}]),angular.module("app").controller("bookingsOperationsStaffingCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,e.charts=[{title:"Front of House Labor Cost per 1,000 Attendees",data:"LaborCostPerAttendee_",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[],info:"Test description for chart 4. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."},{title:"Number of Front of House Staff per 1,000 Attendees",data:"StaffingPerAttendee_",unit:"k",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[],info:"Test description for chart 4. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}];var s=[{id:"FoodBeverage",name:"Food & Beverage"},{id:"Merchandise",name:"Merchandise"},{id:"Security",name:"Security",FOH:!0},{id:"GuestRelations",name:"Guest Relations",FOH:!0},{id:"BoxOffice",name:"Ticket Ops (Box Office)",FOH:!0},{id:"BuildingServices",name:"Building Services",FOH:!0}];a.prepHeader("Bookings-Operations","bookings",["Venue","EventName","Year","Range"],[{name:"MSG Live",url:"bookings"},{name:"Operations"}]),e.$on("init",function(a,t){n.getDataStaffing(e.charts,i.bookings.operationsStaffing,s)})}]),angular.module("app").controller("bookingsOperationsEventCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,e.charts=[{title:"Food & Beverage Total Revenue",type:"column",data:"FoodBeverage",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Food & Beverage Revenue per Cap",type:"column",decimal:2,data:"FoodBeveragePerCap",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[]},{title:"Merchandise Total Revenue",type:"column",data:"Merchandise",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Merchandise Revenue per Cap",type:"column",decimal:2,data:"MerchandisePerCap",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[]}],a.prepHeader("Bookings-Operations","bookings",["Venue","Year","Range"],[{name:"MSG Live",url:"bookings"},{name:"Operations"}]),e.$on("init",function(a,t){n.getData([e.charts],i.bookings.operationsEvent,"EventType")})}]),angular.module("app").controller("bookingsEventDetailCtrl",["$scope","$rootScope","$q","constants","common","bookingsEventDetailSvc",function(e,a,t,i,n,o){if(e.common=n,e.detailResponse={},e.salesCharts=[{title:"Total Tickets Sold",table:"ticket",data:"Sold",unit:"#",format:"#",breakdown:[]},{title:"Average Sell Through Rate",table:"ticket",data:"SellThrough",unit:"%",format:"#",breakdown:[],info:"The number of seats sold (not actual attendees) divided by the capacity of the event."},{title:"Suites Sold",decimal:0,table:"ticket",data:"SuitesSold",unit:"#",format:"#",breakdown:[],info:"Includes Single night rentals and allocated licenses."},{title:"Event-Specific Sponsorship",table:"sponsors",unit:"$",format:"#",breakdown:[],info:"Only includes event-specific sponsorships, not allocated sponsor amounts."}],e.revenueCharts=[{title:"Total MSG Revenue",table:"ticket",data:"Total Revenue",unit:"$",format:"#",breakdown:[],info:"Includes MSG’s portion of ticket sales revenue, license fees, facility fees, and event-specific sponsorships. It does not include food, beverage, or merchandise revenue."},{title:"License Fee",table:"ticket",data:"LicenseFee",unit:"$",format:"#",breakdown:[]},{title:"MSG Ticket Revenue",table:"ticket",data:"Ticket Revenue",unit:"$",format:"#",breakdown:[],info:"The portion of ticket revenue received by MSG. Includes facility fees and MSG’s portion of Ticketmaster fees."},{title:"Suite/Premium Seating Revenue",table:"ticket",data:"SuiteRevenue",unit:"$",format:"#",breakdown:[],info:"Includes Single night rental revenue, revenue from allocated licenses, and premium seating revenue."}],e.revenueChartsCont=[{title:"Ticket Yield",decimal:2,table:"ticket",data:"RevenuePerCap",unit:"$",format:"#",breakdown:[],info:"The total revenue divided by the number of tickets sold – the average revenue per ticket."},{title:"Food & Beverage Revenue per Cap",decimal:2,table:"operations",data:"FoodBeveragePerCap",unit:"$",format:"#",breakdown:[],info:"The total food and beverage revenue divided by the number of attendees."},{title:"Merchandise Revenue per Cap",decimal:2,table:"operations",data:"MerchandisePerCap",unit:"$",format:"#",breakdown:[],info:"The total merchandise revenue divided by the number of attendees."},{title:"Discount Off of Budgeted List Price",decimal:2,table:"ticket",data:"DiscountToFace",unit:"%",format:"#",breakdown:[],info:"The percent difference between the actual ticket yield and budgeted ticket yield."}],e.costCharts=[{title:"Front of House Labor Cost per 1,000 Attendees",table:"operations",data:"LaborCost",unit:"$",format:"#",breakdown:[],info:"Labor cost includes costs from the following categories: food and beverage, merchandise, ticket operations (box office), building services (janitorial), security, and guest relations (ticket takers)."},{title:"Number of Front of House Staff per 1,000 Attendees",table:"operations",data:"StaffCost",unit:"#",format:"#",breakdown:[],info:"Staff totals include the number of staff staff from the following categories: food and beverage, merchandise, ticket operations (box office), building services (janitorial), security, and guest relations (ticket takers)."}],a.eventDetail){var s={name:"Calendar",url:"bookingsCalendar"};a.eventDetail.heatmap&&(s.name="Ticket Sales",s.url="bookingsTickets"),a.prepHeader("Bookings-TicketSales","bookings",[],[{name:"MSG Live",url:"bookings"},s,{name:"Event Details"}]),e.detailDay=a.eventDetail}else n.GoToPage("bookingsCalendar");e.$on("init",function(a,t){o.init(e.detailDay.EventOriginal,e.detailResponse,e.salesCharts.concat(e.revenueCharts,e.revenueChartsCont,e.costCharts))})}]),angular.module("app").controller("bookingsCtrl",["$scope","$rootScope","$q","constants","common","bookingsSvc",function(e,a,t,i,n,o){
e.calendar={url:"bookingsCalendar"},e.common=n,e.charts=[{title:"Ticket Sales & Sponsorship",query:"ticket",graphs:[{title:"Total MSG Revenues",type:"bar",unit:"$",data:"Total Revenue",format:"#",breakdown:[],info:"Total MSG Revenue includes MSG’s portion of ticket sales revenue, license fees, facility fees, and event-specific sponsorships. It does not include food, beverage, or merchandise revenue."},{title:"Average Sell Through Rate",type:"bar",unit:"%",data:"SellThrough",format:"%",breakdown:[],info:"The number of seats sold (not actual attendees) divided by the capacity the events that the seats are sold for"}],url:"bookingsTickets"},{title:"Operations",query:"operations",graphs:[{title:"Venue Utilization",unit:"# of Dark Days",data:"FoodBeveragePerCap",format:"#",breakdown:[],info:"The number of days that a venue is not utilized by an event"}],url:"bookingsOperations"}],a.prepHeader("Bookings-TicketSales","bookings",["FiscalYear","Range"],[{name:"MSG Live",url:"bookings"},{name:"Dashboard"}]),e.$on("init",function(a,t){o.getDarkDays(e.charts[1].graphs[0]),n.getData([e.charts[0].graphs],i.bookings.ticket,!1,!1,"getBookingsSellThroughData")})}]),angular.module("app").controller("bookingsCalendarCtrl",["$rootScope",function(e){e.prepHeader("Bookings-TicketSales","bookings-calendar",["Venue","EventName","Deal","Year","Month","PerformanceCategory"],[{name:"MSG Live",url:"bookings"},{name:"Calendar"}])}]),angular.module("app").controller("sportsTicketsCtrl",["$scope","$rootScope","common","sportsTicketsSvc",function(e,a,t,i){e.common=t,a.prepHeader("Sports-TicketSales","sports",["Team","Season","Range"],[{name:"Sports",url:"sports"},{name:"Ticket Sales"}]),e.chartRevenue={total:[{name:"Total"}],info:"Ticket revenue includes facility fee and MSG’s portion of the Ticketmaster fee"},e.chartRevenue.breakdown=[{name:"Season Tickets & Clubs",id:"Season_Revenue"},{name:"Individual",id:"Individual_Revenue"},{name:"Groups",id:"Group_Revenue"},{name:"Lounges",id:"Lounge_Revenue"},{name:"Suites",id:"Suite_Revenue"}],e.seasonCharts=[{title:"Season Ticket Revenue",caption:"$",data:"Revenue",total:[{name:"Total"}],breakdown:[{name:"Renewals"},{name:"New Fulls"},{name:"Partials"}],info:"Ticket revenue includes facility fee and MSG’s portion of the Ticketmaster fee"},{title:"Season Tickets Sold",caption:"Full-season equivalents",data:"Sold",total:[{name:"Total"}],breakdown:[{name:"Renewals"},{name:"New Fulls"},{name:"Partials"}]},{title:"Ticket Yield",caption:"$",data:"RevenuePerCap",total:[{name:"Total"}],breakdown:[{name:"Renewals"},{name:"New Fulls"},{name:"Partials"}],info:"The total revenue divided by the number of tickets sold – the average revenue per ticket"}],e.seasonMix=[{title:"Actual",type:"Actual",data:[]},{title:"Budget",type:"Budget",data:[]}],e.groupCharts=[{title:"Ticket Revenue",caption:"$",data:"Revenue",total:[{name:"Total"}],breakdown:[{name:"Individual"},{name:"Group"},{name:""}],info:"Ticket revenue includes facility fee and MSG’s portion of the Ticketmaster fee"},{title:"Tickets Sold",caption:"Count",data:"Sold",total:[{name:"Total"}],breakdown:[{name:"Individual"},{name:"Group"},{name:"Comps"}]},{title:"Ticket Yield",caption:"$",data:"RevenuePerCap",total:[{name:"Total"}],breakdown:[{name:"Individual"},{name:"Group"},{name:""}],info:"The total revenue divided by the number of tickets sold – the average revenue per ticket"}],e.loungeCharts=[{title:"Lounge Revenue",caption:"$",data:"Lounge_Revenue",breakdown:[]},{title:"Average Revenue per Lounge",caption:"$",data:"Lounge_RevenuePerCap",breakdown:[]},{title:"Lounges Sold",caption:"# of lounges",data:"Lounge_Sold",breakdown:[],setMax:!0}],e.suiteCharts=[{title:"Total Revenue",caption:"$",data:"Suites_Revenue",total:[{name:"Total"}],breakdown:[{name:"Licenses"},{name:"Single Night Rentals"},{name:"Suite Pass"}]}],e.soldMix={},e.unlicensedSuites={data:[],colors:["#336080","#4d4d4d","#50909a","#84ccac"]},e.avgSuite={},e.renewalSuites={data:[],colors:["#336080","#4d4d4d","#84ccac"]},e.totalTicketsNumber=[{title:"Number of Tickets Allocated",info:"Latest allocation of tickets to be sold for each inventory type (updated weekly)"},{title:"Number of Tickets Available",info:"The difference between the number of tickets allocated and the number of tickets sold for each inventory type"}],e.scrollTo=function(e){var a=$("#"+e);$("html,body").animate({scrollTop:a.offset().top-10},"slow")},e.$on("init",function(a,t){i.initRevenue(e.chartRevenue),i.initSoldMix(e.soldMix),i.initGeneric(e.seasonCharts,"season",["Season_","Season_","Season_","Season_"],["_Total","_Renewal","_New","_Partial"]),i.initSeasonMix(e.seasonMix),i.initGeneric(e.groupCharts,"group",["Total_","Individual_","Group_","Comp_"],["","","",""]),i.initLounge(e.loungeCharts),i.initGeneric(e.suiteCharts,"suite",["","","",""],["_Total","_Licenses","_Single","_SuitePass"]),i.initUnlicensed(e.unlicensedSuites),i.initAvgSuite(e.avgSuite),i.initSuiteMix(e.renewalSuites)})}]),angular.module("app").controller("sportsSponsorshipsCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,a.prepHeader("Sports-TicketSales","sports",["Team","Season","Range"],[{name:"Sports",url:"sports"},{name:"Sponsorships"}]),e.sponsor={},e.$on("init",function(a,t){var o=[n.prepFilters(i.sports.sponsorRevenue),n.prepFilters(i.sports.sponsorType),n.prepFilters(i.sports.sponsorActual)];n.getDataSponsorships(o,e.sponsor)})}]),angular.module("app").controller("sportsOperationsCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,a.prepHeader("Sports-Operations","sports",["Team","Season","Range"],[{name:"Sports",url:"sports"},{name:"Operations"}]),e.chartsAncillary=[{title:"Food & Beverage Total Revenue",type:"column",data:"FoodBeverage",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Food & Beverage Revenue per Cap",type:"column",data:"FoodBeveragePerCap",unit:"$",format:"#",decimal:2,total:[{name:"Average",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"The total food and beverage revenue divided by the number of attendees"},{title:"Merchandise Total Revenue",type:"column",data:"Merchandise",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Merchandise Revenue per Cap",type:"column",data:"MerchandisePerCap",unit:"$",format:"#",decimal:2,total:[{name:"Average",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"The total merchandise revenue divided by the number of attendees"}],e.chartsStaffing=[{title:"Labor cost per 1,000 attendees",type:"column",data:"LaborCostPerAttendee_",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[],info:"Labor cost includes costs from the following categories: food and beverage, merchandise, ticket operations (box office), building services (janitorial), security, and guest relations (ticket takers)"},{title:"Staff per 1,000 attendees",type:"column",data:"StaffingPerAttendee_",unit:"Count",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[],info:"Staff totals include the number of staff staff from the following categories: food and beverage, merchandise, ticket operations (box office), building services (janitorial), security, and guest relations (ticket takers)"},{title:"Overtime Cost",type:"column",data:"OvertimeCost_",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]}];var s=[{id:"FoodBeverage",name:"Food & Beverage"},{id:"Merchandise",name:"Merchandise"},{id:"Security",name:"Security",FOH:!0},{id:"GuestRelations",name:"Guest Relations",FOH:!0},{id:"BoxOffice",name:"Ticket Ops (Box Office)",FOH:!0},{id:"BuildingServices",name:"Building Services",FOH:!0}];e.scrollTo=function(e){var a=$("#"+e);$("html,body").animate({scrollTop:a.offset().top-10},"slow")},e.$on("init",function(a,t){n.getData([e.chartsAncillary],i.sports.operationsAncillary,"Grade","sortGrade"),n.getDataStaffing(e.chartsStaffing,i.sports.operationsStaffing,s)})}]),angular.module("app").controller("sportsCtrl",["$scope","$rootScope","$q","constants","common","sportsSvc",function(e,a,t,i,n,o){e.calendar={url:"sportsCalendar"},e.common=n,e.sports=[{title:"Total Ticket and Suite Revenue by Team",info:"Ticket revenue includes facility fee and MSG’s portion of the Ticketmaster fee"},{title:"Total Ticket and Suite Revenue",info:"Includes ticket revenue, facility fee, MSG’s portion of the Ticketmaster fee, and the allocated amount for Suite revenue"}],a.prepHeader("Sports-TicketSales","sports",["Team","Season","Range"],[{name:"Sports",url:"sports"},{name:"Dashboard"}]),e.seasonChange=function(){o.init(e.sports)},e.$on("init",function(a,t){o.init(e.sports)})}]),angular.module("app").controller("sportsCalendarCtrl",["$rootScope",function(e){e.prepHeader("Sports-TicketSales","sports",["Team","Year","Range"],[{name:"Sports",url:"sports"},{name:"Calendar"}])}]),angular.module("app").controller("productionsTicketsSponsorshipsCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,a.prepHeader("Sponsors","productions",["ShowName","Season"],[{name:"Productions",url:"productions"},{name:"Ticket Sales"}]),e.sponsor={},e.$on("init",function(a,t){var o=[n.prepFilters(i.productions.sponsorRevenue),n.prepFilters(i.productions.sponsorType),n.prepFilters(i.productions.sponsorActual)];n.getDataSponsorships(o,e.sponsor)})}]),angular.module("app").controller("productionsTicketsGradeCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,e.charts=[{title:"Average Ticket Revenue per Performance",uniqShow:!0,type:"column",data:"Revenue",unit:"$",format:"#",total:[{name:"All-Show Average",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"Ticket revenue includes only the base ticket price, not facility fee or MSG’s portion of Ticketmaster Fees. “OP” is opening night"},{title:"Average Ticket Yield",type:"column",data:"RevenuePerCap",unit:"$",format:"#",decimal:2,total:[{name:"All-Show Average",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"Revenue divided by the number of tickets sold – the average revenue per ticket"},{title:"Average Tickets Sold",uniqShow:!0,type:"column",data:"Sold",unit:"Count",format:"#",total:[{name:"All-Show Average",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[]},{title:"Average Sell-Through Rate",perShow:!0,type:"column",data:"SellThrough",unit:"%",format:"%",total:[{name:"All-Show Average",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"The number of seats sold (not actual attendees) divided by the capacity of RCMH"}],a.prepHeader("TicketSales","productions",["ShowName","Season","Range","TimeSlot"],[{name:"Productions",url:"productions"},{name:"Ticket Sales"}]),e.$on("init",function(a,t){e.fromDate&&e.toDate&&n.setTimeSlot(e.fromDate,e.toDate,"TicketSales").then(function(a){e.setTimeSlotFilter(a.data)}),n.getData([e.charts],i.productions.ticketGrade,"Grade","sortGrade","getPerCapData"),n.getSingleData(e.charts[3],i.productions.sellThroughGrade,"Grade","sortGrade","getPerShowGradeData")})}]),angular.module("app").controller("productionsTicketsChannelCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,e.charts=[{title:"Ticket Revenue",type:"column",data:"Revenue",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[],info:"Channels include Individual Full Price (tickets sold without a discount), Individual Discount (tickets sold at a significant discount at places such as tkts), Brokers (tickets sold to 3rd party ticket brokers), Non-broker groups (tickets sold to groups of individuals, at a discount to full-price), and Flash (tickets sold through flash sales websites, e.g. Groupon). Box office is the subset of Individual Full Price and Discount tickets purchased at the Box Office"},{title:"Tickets Sold",type:"column",data:"Sold",unit:"k",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Ticket Yield",type:"column",data:"RevenuePerCap",unit:"$",format:"#",decimal:2,total:[{name:"Average",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"Revenue divided by the number of tickets sold – the average revenue per ticket"}],e.mixCharts=[{title:"Ticket Sales Mix by Channel",type:"mix",data:"Sold",unit:"%",format:"#",breakdown:[{State:"Actual"},{State:"Previous Year"},{State:"Budget"}],info:"Ticket sales mix is based on tickets sold, not ticket revenue"}],e.barCharts=[{title:"Suite/VIP Revenue",type:"bar",data:"SuiteRevenue",unit:"$",format:"#",breakdown:[],info:"Revenue earned from selling a premium experience involving the Roxy Suite"},{title:"Percent of Gross Potential",perShow:!0,type:"bar",data:"PercentageOfGrossPotential",unit:"%",format:"%",breakdown:[],info:"Gross potential is the maximum possible revenue for the venue, assuming all seats are sold at individual full price. This metric shows how close the ticket sales revenue is to this number. It is calculated as: revenue divided by the maximum potential revenue (budgeted individual ticket yield multiplied by capacity of RCMH multiplied by the number of performances)"}],a.prepHeader("TicketSales","productions",["Show","Season","Range","TimeSlot"],[{name:"Productions",url:"productions"},{name:"Ticket Sales"}]),e.$on("init",function(a,t){e.fromDate&&e.toDate&&n.setTimeSlot(e.fromDate,e.toDate,"TicketSales").then(function(a){e.setTimeSlotFilter(a.data)}),n.getData([e.charts,e.mixCharts,e.barCharts],i.productions.ticketChannel,"Channel",!1,"getPerCapData"),n.getSingleData(e.barCharts[1],i.productions.potential)})}]),angular.module("app").controller("productionsOperationsStaffingCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.common=n,e.charts=[{title:"Front of House Labor Cost per 1,000 Attendees ",data:"LaborCostPerAttendee_",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[],info:"Totals include straight time and overtime. Prior year labor data is currently unavailable"},{title:"Staff per 1,000 Attendees",data:"StaffingPerAttendee_",unit:"Count",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[],info:"Represents number of staff per day (a full crew), not number of staff per show. Prior year labor data is currently unavailable"}],a.prepHeader("Operations","productions",["ShowName","Season","Range","TimeSlot"],[{name:"Productions",url:"productions"},{name:"Operations"}]);var s=[{id:"FoodBeverage",name:"Food & Beverage"},{id:"Merchandise",name:"Merchandise"},{id:"Security",name:"Security",FOH:!0},{id:"GuestRelations",name:"Guest Relations",FOH:!0},{id:"BoxOffice",name:"Ticket Ops (Box Office)",FOH:!0},{id:"BuildingServices",name:"Building Services",FOH:!0}];e.$on("init",function(a,t){e.fromDate&&e.toDate&&n.setTimeSlot(e.fromDate,e.toDate,"Operations").then(function(a){e.setTimeSlotFilter(a.data)}),n.getDataStaffing(e.charts,i.productions.operationsStaffing,s)})}]),angular.module("app").controller("productionsOperationsAncillaryCtrl",["$scope","$rootScope","$q","constants","common",function(e,a,t,i,n){e.common=n,e.charts=[{title:"Food & Beverage Total Revenue",type:"column",data:"FoodBeverage",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Food & Beverage Revenue per Cap",type:"column",data:"FoodBeveragePerCap",unit:"$",format:"#",decimal:2,total:[{name:"Average",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"The total food and beverage revenue divided by the number of attendees"},{title:"Merchandise Total Revenue",type:"column",data:"Merchandise",unit:"$",format:"#",total:[{name:"Total",actual:0,budget:0,prior:0}],breakdown:[]},{title:"Merchandise Revenue per Cap",type:"column",data:"MerchandisePerCap",unit:"$",format:"#",decimal:2,total:[{name:"Average",actual:0,budget:0,prior:0}],totalAVG:!0,breakdown:[],info:"The total merchandise revenue divided by the number of attendees"}],a.prepHeader("Operations","productions",["ShowName","Season","Range","TimeSlot"],[{name:"Productions",url:"productions"},{name:"Operations"}]),e.$on("init",function(a,t){e.fromDate&&e.toDate&&n.setTimeSlot(e.fromDate,e.toDate,"Operations").then(function(a){e.setTimeSlotFilter(a.data)}),n.getData([e.charts],i.productions.operationsAncillary,"Grade","sortGrade","getPerCapData")})}]),angular.module("app").controller("productionsCtrl",["$scope","$rootScope","$q","constants","common",function(e,a,t,i,n){e.calendar={url:"productionsCalendar"},e.common=n,e.charts=[{title:"Ticket Sales and Sponsorships",graphs:[{title:"Ticket Revenue",type:"bar",unit:"$",data:"Revenue",format:"#",breakdown:[],info:"Ticket revenue includes only the base ticket price, not facility fee or MSG’s portion of Ticketmaster Fees"},{title:"Ticket Sell-Through Rate",perShow:!0,type:"bar",unit:"%",data:"SellThrough",format:"%",breakdown:[],info:"The number of seats sold (not actual attendees) divided by the capacity of RCMH"},{title:"Total Tickets Sold",type:"bar",unit:"Count",data:"Sold",format:"#",breakdown:[],info:""},{title:"Ticket Yield",type:"bar",unit:"$",data:"RevenuePerCap",format:"#",decimal:2,breakdown:[],info:"The total revenue divided by the number of tickets sold – the average revenue per ticket"}],url:"productionsTicketsChannel"},{title:"Operations",graphs:[{title:"Food & Beverage Revenue per Cap",type:"bar",unit:"$",data:"FoodBeveragePerCap",format:"#",decimal:2,breakdown:[],info:"The total food and beverage revenue divided by the number of attendees. Budgeted attendees are based off of show grade-level budgets"},{title:"Merchandise Revenue per Cap",type:"bar",unit:"$",data:"MerchandisePerCap",format:"#",decimal:2,breakdown:[],info:"The total merchandise revenue divided by the number of attendees. Budgeted attendees are based off of show grade-level budgets"},{title:"Front of House Labor Cost per 1,000 Attendees ",type:"bar",unit:"$",data:"LaborCostPerAttendee",format:"#",breakdown:[],info:"Labor cost includes costs from the following categories: food and beverage, merchandise, ticket operations (box office), building services (janitorial), security, and guest relations (ticket takers). Prior year labor data is currently unavailable"},{title:"Customer Satisfaction",type:"bar",unit:"%, n = 0",data:"CustomerSatisfaction",format:"#",breakdown:[],info:"To be defined"}],url:"productionsOperationsAncillary"}],a.prepHeader("TicketSales","productions",["ShowName","Season","Range","TimeSlot"],[{name:"Productions",url:"productions"},{name:"Dashboard"}]),e.$on("init",function(a,t){e.fromDate&&e.toDate&&n.setTimeSlot(e.fromDate,e.toDate,"TicketSales").then(function(a){e.setTimeSlotFilter(a.data)}),n.getData([e.charts[0].graphs],i.productions.ticket,!1,!1,"getPerCapData"),n.getSingleData(e.charts[0].graphs[1],i.productions.sellThrough),n.getOperationData([e.charts[1].graphs],i.productions.operations,!1,!1,"getPerCapData")})}]),angular.module("app").controller("productionsCalendarCtrl",["$rootScope",function(e){e.prepHeader("TicketSales","productions",["ShowName","Year","Month","PerformanceCategory"],[{name:"Productions",url:"productions"},{name:"Calendar"}])}]),angular.module("app").directive("stacked",["common",function(e){return{restrict:"A",replace:!0,scope:{data:"=",format:"="},controller:["$scope","$element","common",function(e,a,t){var i={top:5,right:0,bottom:30,left:40},n=$(a).parent().width()-i.left-i.right,o=200-i.top-i.bottom,s=3,r=d3.scale.ordinal().rangeRoundBands([0,n],.75),l=d3.scale.linear().range([o,0]),d=d3.scale.ordinal().range(["#50909a","#84ccac","#f68428","#336080","#0068b3","#d0743c"]),c=d3.svg.axis().tickSize(0).ticks(s).scale(l),u=d3.select(a[0]).append("svg").attr("width",n+i.left+i.right).attr("height",o+i.top+i.bottom).append("g").attr("transform","translate("+i.left+","+i.top+")"),p=d3.svg.axis().tickSize(0).tickPadding(10).scale(r).orient("bottom"),v=function(a){if(u.selectAll("*").remove(),d.domain(d3.keys(a[0]).filter(function(e){return"State"!==e})),0!==d.domain().length){a.forEach(function(e){var a=0;e.ages=d.domain().map(function(t){return{name:t,val:e[t],y0:a,y1:a+=+e[t]}}),e.total=e.ages[e.ages.length-1].y1}),r.domain(a.map(function(e){return e.State})),l.domain([0,d3.max(a,function(e){return e.total})]),u.append("g").attr("class","x axis").attr("transform","translate(0,"+o+")").call(p);var i=c.ticks(s).tickSize(-n,0).orient("left").tickFormat(function(a){return t.format(a,e.format)});u.append("g").classed("y",!0).classed("grid",!0).call(i);var v=u.selectAll(".state").data(a).enter().append("g").attr("class","g").attr("transform",function(e){return"translate("+r(e.State)+",0)"});v.selectAll("rect").data(function(e){return e.ages}).enter().append("rect").attr("width",r.rangeBand()).attr("y",function(e){return l(e.y1)}).attr("height",function(e){return l(e.y0)-l(e.y1)}).style("fill",function(e){return d(e.name)}),v.selectAll("text").data(function(e){return e.ages}).enter().append("text").text(function(e){return e.val?t.format(e.val,"#"):void 0}).attr("class","bar-value").attr("x",function(e){return r.rangeBand()/2-this.getComputedTextLength()/2}).attr("y",function(e){return(l(e.y0)+l(e.y1))/2})}};e.$watch("data",function(){e.data&&v(_.cloneDeep(e.data))},!0)}]}}]),angular.module("app").directive("popoverDir",[function(){return{restrict:"E",scope:{info:"@info","class":"@class"},template:'<div class="info"  ng-show="calendar_performance.info" data-toggle="popover" data-content="{{calendar_performance.info}}">i</div>',link:function(e,a,t){e["class"]&&a.find("div").addClass(e["class"])},controller:["$scope",function(e){setTimeout(function(){$('[data-toggle="popover"]').popover()},300),e.calendar_performance={info:e.info}}]}}]),angular.module("app").directive("msgCalendar",msgCalendar),msgCalendar.$inject=["$rootScope","constants","common","DataDelegate"],angular.module("app").directive("heatmap",function(){return{restrict:"A",replace:!0,scope:{data:"=",ycats:"=",xcats:"=",format:"="},controller:["$scope","$element","$rootScope","common",function(e,a,t,i){function n(e,a){e.each(function(){for(var e,t=d3.select(this),i=t.text().split(/\s+/).reverse(),n=[],o=0,s=1.3,r=t.attr("x"),l=(t.attr("y"),parseFloat(t.attr("dy"))),d=t.text(null).append("tspan").attr("dy",l+"em");e=i.pop();)n.push(e),d.text(n.join(" ")),d.node().getComputedTextLength()>a&&(n.pop(),d.text(n.join(" ")),n=[e],d=t.append("tspan").attr("x",r).attr("dy",++o*s+l+"em").text(e));o>0&&t.attr("y",-14*o)})}var o=function(o){d3.select(a[0]).selectAll("*").remove(),o=_.cloneDeep(o);var r={top:40,right:0,bottom:0,left:150},l=$(a).parent().width()-r.left-r.right,d=Math.floor(l/_.max(o,function(e){return e.x}).x)-1,c=d*_.max(o,function(e){return e.y}).y+r.top+r.bottom,u=2,p=10,v=3,f=["#d31145","#005696","#99cb55"],g=e.ycats,m=e.xcats,h=e.format,S=d3.select(a[0]).append("svg").attr("class","heatmap").attr("width",l+r.left+r.right).attr("height",c+r.top+r.bottom).append("g").attr("transform","translate("+r.left+","+r.top+")");S.selectAll(".yLabel").data(g).enter().append("text").text(function(e){return e}).attr("x",0).attr("y",function(e,a){return a===g.length-1?a*d-2*u+p:a*d-2*u}).style("text-anchor","end").attr("transform","translate(-6,"+(d-2*u)/1.5+")").attr("class",function(e,a){return a>=0&&4>=a?"yLabel mono axis axis-workweek":"yLabel mono axis"}),S.selectAll(".xLabel").data(m).enter().append("text").text(function(e){return e}).attr("x",function(e,a){return a===m.length-1?a*d-u/2+p:a*d-u/2}).attr("dy","0").attr("y",0).style("text-anchor","middle").attr("transform","translate("+(d-u)/2+", -6)").attr("class",function(e,a){return a>=7&&16>=a?"xLabel mono axis axis-x":"xLabel mono axis"});S.selectAll(".xLabel").call(n,d-10);var k=_.where(o,function(e){return!e.total}),b=d3.scale.quantile().domain([0,v-1,d3.max(k,function(e){return e.value})]).range(f),y=S.selectAll(".x").data(o,function(e){return e.y+":"+e.x});y.append("title"),y.enter().append("rect").attr("x",function(e){return e.x===m.length?(e.x-1)*d+p:(e.x-1)*d}).attr("y",function(e){return e.y===g.length?(e.y-1)*d+p:(e.y-1)*d}).attr("class","heatmap-square").attr("width",d-u).attr("height",d-u).style("fill","#f2f2f2").on("click",function(e,a){s(e,a)}),y.transition().duration(1e3).style("fill",function(e){return e.total?e.color="#aaaaaa":e.color=b(e.value),e.color}),y.enter().append("text").text(function(e){return i.format(e.value,h,0)}).attr("font-size","20px").attr("x",function(e){return e.x===m.length?(e.x-1)*d+d/2-this.getComputedTextLength()/2+p:(e.x-1)*d+d/2-this.getComputedTextLength()/2}).attr("y",function(e){return e.y===g.length?(e.y-1)*d+d/2+u+p+5:(e.y-1)*d+d/2+u+5}).attr("class","heatmap-value").on("click",function(e,a){s(e,a)}),y.enter().append("circle").attr("cx",function(e){return e.x===m.length?(e.x-1)*d+d/2-u/2+p:(e.x-1)*d+d/2-u/2}).attr("cy",function(e){return e.y===g.length?(e.y-1)*d+d/2+p:(e.y-1)*d+d/2}).attr("id",function(e,a){return"circle-"+a}).attr("r",25).attr("class","heatmap-circle").on("click",function(e,a){s(e,a)}),s(o[0],0),t.$broadcast("heatmapHeight",c),y.exit().remove()},s=function(e,a){var i=d3.select("#circle-"+a),n=d3.selectAll(".selected");n[0].length>0&&n.attr("class",n.attr("class").replace(" selected","")),i.attr("class",i.attr("class")+" selected"),t.$broadcast("heatmapSelect",e)};e.$watch("data",function(){e.data&&o(e.data)},!0)}]}}),angular.module("app").directive("column",function(){return{restrict:"A",replace:!0,scope:{data:"=",format:"=",decimal:"=",border:"=",height:"="},controller:["$scope","$element","common",function(e,a,t){function i(e,a){e.each(function(){for(var e,t=d3.select(this),i=t.text().split(/\s+/).reverse(),n=[],o=0,s=1.1,r=t.attr("y"),d=parseFloat(t.attr("dy")),c=t.text(null).append("tspan").attr("x",function(e){return"Box Office"===e?l:0}).attr("y",r).attr("dy",d+"em");e=i.pop();)n.push(e),c.text(n.join(" ")),c.node().getComputedTextLength()>a&&(n.pop(),c.text(n.join(" ")),n=[e],c=t.append("tspan").attr("x",0).attr("y",r).attr("dy",++o*s+d+"em").text(e))})}var n={top:10,right:0,bottom:30,left:40},o=$(a).parent().width()-n.left-n.right,s=200-n.top-n.bottom,r=3,l=40,d=0;e.height&&(s=e.height-n.top-n.bottom);var c=d3.scale.ordinal().rangeRoundBands([0,o],.5),u=d3.scale.linear().range([s,0]),p=d3.svg.axis().tickSize(0).ticks(r).scale(u),v=d3.select(a[0]).append("svg").attr("width",o+n.left+n.right).attr("height",s+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")"),f=d3.svg.axis().tickSize(0).tickPadding(10).scale(c).orient("bottom"),g=function(a){v.selectAll("*").remove(),c.domain(a.map(function(e){return e.name})),"%"===e.format?u.domain([0,1]):u.domain([0,d3.max(a,function(e){return d3.max([e.budget,e.prior,e.actual],function(e){return 1.1*e})})]),v.append("g").attr("class","x axis").attr("transform","translate(0,"+s+")").call(f).selectAll(".tick text").call(i,c.rangeBand()+20);var n=p.ticks(r).tickSize(-o,0).orient("left").tickFormat(function(a){return t.format(a,e.format,0)});v.append("g").classed("y",!0).classed("grid",!0).call(n);var g=v.selectAll(".bars").data(a).enter().append("g");g.append("rect").attr("y",s).attr("height",0).transition().duration(500).attr("class",function(e){return e.actual<e.budget?"bar-budget":"bar-actual"}).attr("x",function(e){return"Box Office"===e.name&&(d=c(e.name)),c(e.name)+("Box Office"===e.name?l:0)}).attr("width",c.rangeBand()).attr("y",function(e){return e.actual||e.budget?u(e.actual<e.budget?e.budget:e.actual):void 0}).attr("height",function(e){return e.actual||e.budget?s-u(e.actual<e.budget?e.budget:e.actual):void 0}),g.append("rect").attr("y",s).attr("height",0).transition().duration(500).attr("class",function(e){return e.actual<=e.budget?"bar-actual":"bar-budget"}).attr("x",function(e){return c(e.name)+("Box Office"===e.name?l:0)}).attr("width",c.rangeBand()).attr("y",function(e){return e.actual&&e.budget?u(e.actual<=e.budget?e.actual:e.budget):void 0}).attr("height",function(e){return e.actual&&e.budget?s-u(e.actual<=e.budget?e.actual:e.budget):void 0});var m=3,h=function(e){if(e.actual||e.budget){var a=e.actual<e.budget?u(e.budget)+m:u(e.actual)+m;return a>s-m-8&&(a=s-m-8),a}return s},S=function(e){return h(e)<s-m-10?!1:!0},k=function(e){return u(e.actual)>s-m-10&&u(e.budget)>s-m-10?" dark":u(e.actual)>s-m-10&&!e.budget?" dark":u(e.budget)>s-m-10&&!e.actual?" dark":""},b=function(e){return S(e)?e.actual<e.budget||0===e.actual?"transparent":"bar-value"+k(e):"bar-value"},y=function(e){return S(e)?e.actual<e.budget?"bar-value"+k(e):"transparent":"bar-value"};g.append("text").text(function(a){return t.format(a.actual<a.budget?a.actual:a.budget,e.format,e.decimal)}).attr("class",function(e){return y(e)}).attr("x",function(e){return c(e.name)+c.rangeBand()-this.getComputedTextLength()-m+("Box Office"===e.name?l:0)}).attr("y",function(e){return s-m}),g.append("text").text(function(a){return t.format(a.actual<a.budget?a.budget:a.actual,e.format,e.decimal)}).attr("dy",".75em").attr("class",function(e){return b(e)}).attr("x",function(e){return c(e.name)+c.rangeBand()-this.getComputedTextLength()-m+("Box Office"===e.name?l:0)}).attr("y",function(e){return h(e)});var T=7;g.append("text").text(function(a){return a.prior?t.format(a.prior,e.format,e.decimal):void 0}).attr("class","prior-value").attr("x",function(e){return e.prior?c(e.name)-this.getComputedTextLength()+("Box Office"===e.name?l:0)-T:void 0}).attr("y",function(e){return e.prior?u(e.prior)+m:void 0});var _=function(e){return[{x:c(e.name)-T+("Box Office"===e.name?l:0),y:u(e.prior)},{x:c(e.name)+("Box Office"===e.name?l:0),y:u(e.prior)+T},{x:c(e.name)+T+("Box Office"===e.name?l:0),y:u(e.prior)},{x:c(e.name)+("Box Office"===e.name?l:0),y:u(e.prior)-T}]},w=d3.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate("linear");g.append("path").attr("d",function(e){return 0===e.prior||e.prior?w(_(e)):void 0}).attr("stroke-width",2).attr("fill","#fdc739"),e.border&&g.append("line").attr("class","split-line").attr("x1",d-10).attr("y1",-10).attr("x2",d-10).attr("y2",185)};e.$watch("data",function(){e.data&&g(e.data)},!0)}]}}),angular.module("app").directive("bar",["common",function(e){return{restrict:"A",replace:!0,templateUrl:"views/directives/bar-dir.html",scope:{data:"=",format:"=",max:"=",decimal:"=",shape:"="},controller:["$scope","common",function(e,a){e.common=a,e.calcPos=function(t){if(a.checkUndefined(e.data)){var i=e.data[0];return e.data.length>1&&(i=Math.max.apply(Math,e.data)),e.max&&i<e.max?t/e.max*100:t/i*100}},e.getLower=function(){return a.checkUndefined(e.data)?e.data.length>1?Math.min.apply(Math,e.data.slice(0,2)):e.data[0]:void 0},e.getBigger=function(){return a.checkUndefined(e.data)?e.data.length>1?Math.max.apply(Math,e.data.slice(0,2)):e.data[0]:void 0},e.getBiggerPos=function(){return 100-e.calcPos(e.getBigger())};var t=function(){if(e.data&&e.data.length>0){var a=e.data;e.data=[0,0,0],setTimeout(function(){e.data=a,e.$apply()},500)}};t()}]}}]),angular.module("app").factory("SenecaInterceptor",["$q",function(e){return{response:function(e){if(302===e.status&&"/my.policy"===e.headers("Location"))window.location.reload();else{if(!(200===e.status&&"string"==typeof e.data&&e.data.indexOf("Enter supplied logon credentials")>0))return e;window.location.reload()}},responseError:function(a){return 401!==a.status?e.reject(a):void window.location.reload()}}}]),angular.module("app").factory("preloader",["$q","$rootScope",function(e,a){function t(a){this.imageLocations=a,this.imageCount=this.imageLocations.length,this.loadCount=0,this.errorCount=0,this.states={PENDING:1,LOADING:2,RESOLVED:3,REJECTED:4},this.state=this.states.PENDING,this.deferred=e.defer(),this.promise=this.deferred.promise}return t.preloadImages=function(e){var a=new t(e);return a.load()},t.prototype={constructor:t,isInitiated:function(){return this.state!==this.states.PENDING},isRejected:function(){return this.state===this.states.REJECTED},isResolved:function(){
return this.state===this.states.RESOLVED},load:function(){if(this.isInitiated())return this.promise;this.state=this.states.LOADING;for(var e=0;e<this.imageCount;e++)this.loadImageLocation(this.imageLocations[e]);return this.promise},handleImageError:function(e){this.errorCount++,this.isRejected()||(this.state=this.states.REJECTED,this.deferred.reject(e))},handleImageLoad:function(e){this.loadCount++,this.isRejected()||(this.deferred.notify({percent:Math.ceil(this.loadCount/this.imageCount*100),imageLocation:e}),this.loadCount===this.imageCount&&(this.state=this.states.RESOLVED,this.deferred.resolve(this.imageLocations)))},loadImageLocation:function(e){var t=this,i=$(new Image).load(function(e){a.$apply(function(){t.handleImageLoad(e.target.src),t=i=e=null})}).error(function(e){a.$apply(function(){t.handleImageError(e.target.src),t=i=e=null})}).prop("src",e)}},t}]),angular.module("app").factory("DataProcessor",[function(){var e={};return e.processWallaceData=function(e){return e},e.processPerCapData=function(e){return _.each(e.data,function(e){var a=e.Sold?e.Sold:e.Attendees;for(var t in e)e.hasOwnProperty(t)&&t.indexOf("PerCap")>-1&&(e[t]=e[t.replace("PerCap","")]/a)}),e},e.processPerShowGradeData=function(e){var a="Type";e.data[0].Grade&&(a="Grade");var t=_.uniq(e.data,a);return _.each(t,function(t){var i=0,n=_.reduce(e.data,function(e,n){return n[a]===t[a]?(i++,e+n.SellThrough):e},0);t.SellThrough=n/i}),e.data=t,e},e.processBookingsSellThrough=function(e){return _.each(e.data,function(e){e.SellThrough=e.Sold/e.Capacity}),e},e}]),angular.module("app").factory("DataDelegate",["DataProcessor","DataQuery",function(e,a){var t={};return t.getWallaceData=function(t){return a.getWallaceData(t).then(function(a){return e.processWallaceData(a)})},t.getPerCapData=function(t){return a.getWallaceData(t).then(function(a){return e.processPerCapData(a)})},t.getPerShowGradeData=function(t){return a.getWallaceData(t).then(function(a){return e.processPerShowGradeData(a)})},t.getBookingsSellThroughData=function(t){return a.getWallaceData(t).then(function(a){return e.processBookingsSellThrough(a)})},t.skeuosData=function(e,t){return a.skeuosData(e,t)},t}]),angular.module("app").factory("constants",["$rootScope",function(e){var a={};return a.productions={},a.bookings={},a.sports={},a.eventDetails={},a.queryShow={aggregate:[{$group:{_id:"$ShowName"}}]},a.queryFiscalYear={aggregate:[{$group:{_id:"$FiscalYear"}},{$sort:{_id:-1}}],dataset:"Bookings-TicketSales"},a.querySeason={aggregate:[{$group:{_id:"$Season"}}]},a.queryTimeSlot={aggregate:[{$group:{_id:"$TimeSlot"}}]},a.queryMatchTimeSlot={aggregate:[{$match:{Date:{$lte:"20160131",$gte:"20130101"}}},{$group:{_id:"$TimeSlot"}}]},a.queryVenue={aggregate:[{$group:{_id:"$Venue"}}]},a.queryEvent={aggregate:[{$group:{_id:"$EventName"}}]},a.queryPerformance={aggregate:[{$group:{_id:"$PerformanceCategory"}}]},a.queryDeal={aggregate:[{$group:{_id:"$DealType"}}]},a.queryYear={fields:[{field:"Date",using:"sum"}],by:[{field:"Date",using:"year"}]},a.querySportsCalendar={fields:[{field:"Performance",using:"avg"},{field:"PerformanceCategory",using:"first"}],by:["Date","Opponent","Result","Team","Time"],filters:{Type:"Actual",Date:{lt:"20160131",gt:"20130101"}},dataset:"Sports-TicketSales",sort:[{Date:"asc"},{TimeSlot:"asc"}]},a.queryBookingsCalendar={fields:[{field:"Performance",using:"first"},{field:"SellThrough",using:"first"},{field:"Event",using:"first"},{field:"EventId",using:"first"},{field:"Revenue",using:"first"},{field:"ProjectedContribution",using:"first"},{field:"ProjectedContributionPerTicket",using:"first"},{field:"Sold",using:"first"},{field:"Type",using:"first"}],by:["Date","Venue","EventName","TimeSlot"],filters:{Type:"C",Date:{lt:"20160131",gt:"20130101"}},dataset:"Bookings-TicketSales",sort:[{Date:"asc"},{TimeSlot:"asc"}]},a.queryCalendar={fields:[{field:"PerformanceCategory",using:"first"},{field:"SellThrough",using:"avg"}],by:["Season","Date","TimeSlot","Grade"],filters:{Type:"Actual",ShowName:"Radio City Christmas Spectacular",Date:{lt:"20160131",gt:"20130101"}},dataset:"TicketSales",sort:[{Date:"asc"},{TimeSlot:"asc"}]},a.queryCalendarTotal={fields:[{field:"Sold",using:"sum"},{field:"SellThrough",using:"avg"},{field:"RevenuePerCap",using:"avg"},{field:"Revenue",using:"sum"},{field:"DiscountToFace",using:"avg"},{field:"Performance",using:"avg"},{field:"StartDate",using:{min:"$Date"}},{field:"EndDate",using:{max:"$Date"}},{field:"count",using:{sum:1}}],by:[{field:"Date",using:"week"}],filters:{Type:"Actual",ShowName:"Radio City Christmas Spectacular",Date:{lt:"20160131",gt:"20130101"}},dataset:"TicketSales",sort:[{Date:"asc"}]},a.productions.ticket={fields:[{field:"Revenue",using:"sum"},{field:"Sold",using:"sum"},{field:"RevenuePerCap",using:"avg"}],by:["Type"],filters:{Type:"Actual"},dataset:"TicketSales",sort:[{Channel:"asc"}]},a.productions.sellThrough={fields:[{field:"SellThrough",using:"avg"}],by:["Type","ShowId"],filters:{Type:"Actual"},dataset:"TicketSales",sort:[{Channel:"asc"}]},a.productions.operations={fields:[{field:"Attendees",using:"sum"},{field:"FoodBeverage",using:"sum"},{field:"FoodBeveragePerCap",using:"avg"},{field:"Merchandise",using:"sum"},{field:"MerchandisePerCap",using:"avg"},{field:"LaborCostPerAttendee",using:{sum:{add:["$LaborCostPerAttendee_BoxOffice","$LaborCostPerAttendee_BuildingServices","$LaborCostPerAttendee_Security","$LaborCostPerAttendee_GuestRelations"]}}},{field:"CustomerSatisfaction",using:"sum"}],by:["Type"],filters:{Type:"Actual"},dataset:"Operations"},a.productions.ticketChannel={fields:[{field:"Revenue",using:"sum"},{field:"Sold",using:"sum"},{field:"RevenuePerCap",using:"avg"},{field:"SellThrough",using:"avg"},{field:"DiscountToFace",using:"avg"},{field:"SuiteRevenue",using:"sum"}],by:["Channel"],filters:{Type:"Actual"},dataset:"TicketSales",sort:[{Channel:"asc"}]},a.productions.potential={fields:[{field:"PercentageOfGrossPotential",using:"avg"}],by:["Type","ShowId"],filters:{Type:"Actual"},dataset:"TicketSales",sort:[{Channel:"asc"}]},a.productions.ticketGrade={fields:[{field:"Revenue",using:"sum"},{field:"Sold",using:"sum"},{field:"RevenuePerCap",using:"avg"},{field:"DiscountToFace",using:"avg"}],by:["Grade"],filters:{Type:"Actual"},dataset:"TicketSales",sort:[{Grade:"asc"}]},a.productions.uniqShows={fields:[{field:"Revenue",using:"sum"},{field:"Sold",using:"sum"}],by:["Grade","ShowId","Type"],filters:{},dataset:"TicketSales",sort:[{Grade:"asc"}]},a.productions.sellThroughGrade={fields:[{field:"SellThrough",using:"avg"}],by:["Grade","ShowId"],filters:{Type:"Actual"},dataset:"TicketSales",sort:[{Channel:"asc"}]},a.productions.sponsorRevenue={fields:[{field:"Revenue",using:"sum"}],by:["Sponsor"],filters:{},dataset:"Sponsors",sort:[{Sponsor:"asc"}]},a.productions.sponsorActual={fields:[{field:"Revenue",using:"sum"}],by:["SponsorType"],filters:{},dataset:"Sponsors",sort:[{SponsorType:"asc"}]},a.productions.sponsorType={fields:[{field:"Budget",using:"sum"},{field:"PriorYear",using:"sum"}],by:["SponsorType"],filters:{},dataset:"SponsorBudget",sort:[{SponsorType:"asc"}]},a.productions.operationsAncillary={fields:[{field:"Attendees",using:"sum"},{field:"FoodBeverage",using:"sum"},{field:"FoodBeveragePerCap",using:"avg"},{field:"Merchandise",using:"sum"},{field:"MerchandisePerCap",using:"avg"}],by:["Grade"],filters:{Type:"Actual"},dataset:"Operations",sort:[{Grade:"asc"}]},a.productions.operationsStaffing={fields:[{field:"LaborCostPerAttendee_FoodBeverage",using:"avg"},{field:"LaborCostPerAttendee_Merchandise",using:"avg"},{field:"LaborCostPerAttendee_BoxOffice",using:"avg"},{field:"LaborCostPerAttendee_BuildingServices",using:"avg"},{field:"LaborCostPerAttendee_Security",using:"avg"},{field:"LaborCostPerAttendee_GuestRelations",using:"avg"},{field:"OvertimeCost_FoodBeverage",using:"sum"},{field:"OvertimeCost_Merchandise",using:"sum"},{field:"OvertimeCost_BoxOffice",using:"sum"},{field:"OvertimeCost_BuildingServices",using:"sum"},{field:"OvertimeCost_Security",using:"sum"},{field:"OvertimeCost_GuestRelations",using:"sum"},{field:"StaffingPerAttendee_FoodBeverage",using:"avg"},{field:"StaffingPerAttendee_Merchandise",using:"avg"},{field:"StaffingPerAttendee_BoxOffice",using:"avg"},{field:"StaffingPerAttendee_BuildingServices",using:"avg"},{field:"StaffingPerAttendee_Security",using:"avg"},{field:"StaffingPerAttendee_GuestRelations",using:"avg"}],by:["Type"],filters:{},dataset:"Operations"},a.bookings.ticket={fields:[{field:"Total Revenue",using:"sum"},{field:"Sold",using:"sum"},{field:"Capacity",using:"sum"}],by:["Type"],filters:{Type:"A"},dataset:"Bookings-TicketSales"},a.bookings.ticketBoth={fields:[{field:"EventName",using:"first"},{field:"EventType",using:"first"},{field:"Venue",using:"first"},{field:"Date",using:"first"},{field:"SellThrough",using:"first"},{field:"Revenue",using:"first"},{field:"Sold",using:"first"},{field:"TimeSlot",using:"first"},{field:"ProjectedContribution",using:"first"},{field:"ProjectedContributionPerTicket",using:"first"}],by:["Event"],filters:{Type:"A"},dataset:"Bookings-TicketSales",sort:[{Date:"desc"}]},a.bookings.ticketVenue={fields:[{field:"Revenue",using:"sum"},{field:"Sold",using:"sum"},{field:"RevenuePerCap",using:"avg"},{field:"DiscountToFace",using:"avg"}],by:["Venue"],filters:{Type:"A"},dataset:"Bookings-TicketSales",sort:[{EventName:"asc"}]},a.bookings.ticketEvent={fields:[{field:"Revenue",using:"sum"},{field:"Sold",using:"sum"},{field:"RevenuePerCap",using:"avg"},{field:"DiscountToFace",using:"avg"}],by:["EventType"],filters:{Type:"A"},dataset:"Bookings-TicketSales",sort:[{EventName:"asc"}]},a.bookings.ticketSponsorships={fields:[{field:"Revenue",using:"sum"},{field:"Budget",using:"sum"},{field:"PriorYear",using:"sum"},{field:"SponsorType",using:"first"}],by:["Sponsor"],filters:{},dataset:"Bookings-Sponsors",sort:[{EventName:"asc"}]},a.bookings.operations={fields:[{field:"Actual",using:{sum:{cond:[{eq:["$Type","C"]},1,0]}}}],by:["Venue"],filters:{},dataset:"Bookings-TicketSales"},a.bookings.operationsVenue={fields:[{field:"FoodBeverage",using:"sum"},{field:"FoodBeveragePerCap",using:"avg"},{field:"Merchandise",using:"sum"},{field:"MerchandisePerCap",using:"avg"}],by:["Venue"],filters:{Type:"Actual"},dataset:"Bookings-Operations",sort:[{EventName:"asc"}]},a.bookings.operationsEvent={fields:[{field:"FoodBeverage",using:"sum"},{field:"FoodBeveragePerCap",using:"avg"},{field:"Merchandise",using:"sum"},{field:"MerchandisePerCap",using:"avg"}],by:["EventType"],filters:{Type:"Actual"},dataset:"Bookings-Operations",sort:[{EventName:"asc"}]},a.bookings.operationsStaffing={fields:[{field:"LaborCostPerAttendee_FoodBeverage",using:"avg"},{field:"LaborCostPerAttendee_Merchandise",using:"avg"},{field:"LaborCostPerAttendee_BoxOffice",using:"avg"},{field:"LaborCostPerAttendee_BuildingServices",using:"avg"},{field:"LaborCostPerAttendee_Security",using:"avg"},{field:"LaborCostPerAttendee_GuestRelations",using:"avg"},{field:"StaffingPerAttendee_FoodBeverage",using:"avg"},{field:"StaffingPerAttendee_Merchandise",using:"avg"},{field:"StaffingPerAttendee_BoxOffice",using:"avg"},{field:"StaffingPerAttendee_BuildingServices",using:"avg"},{field:"StaffingPerAttendee_Security",using:"avg"},{field:"StaffingPerAttendee_GuestRelations",using:"avg"}],by:["Type"],filters:{},dataset:"Bookings-Operations"},a.bookings.operationsSummaryAncillary={fields:[{field:"FoodBeveragePerCap",using:"avg"},{field:"FoodBeverage",using:"sum"},{field:"MerchandisePerCap",using:"avg"},{field:"Merchandise",using:"sum"}],by:["EventName"],filters:{Type:"Actual"},dataset:"Bookings-Operations",sort:[{EventName:"asc"}]},a.bookings.operationsSummaryStaffing={fields:[{field:"LaborCost",using:{avg:{add:["$LaborCostPerAttendee_FoodBeverage","$LaborCostPerAttendee_Merchandise","$LaborCostPerAttendee_BoxOffice","$LaborCostPerAttendee_BuildingServices","$LaborCostPerAttendee_Security","$LaborCostPerAttendee_GuestRelations"]}}},{field:"Staffing",using:{avg:{add:["$StaffingPerAttendee_FoodBeverage","$StaffingPerAttendee_Merchandise","$StaffingPerAttendee_BoxOffice","$StaffingPerAttendee_BuildingServices","$StaffingPerAttendee_Security","$StaffingPerAttendee_GuestRelations"]}}}],by:["EventName"],filters:{Type:"Actual"},dataset:"Bookings-Operations",sort:[{EventName:"asc"}]},a.bookings.operationsSummaryGuest={fields:[{field:"GuestSatisfaction",using:"sum"}],by:["Venue"],filters:{Type:"Actual"},dataset:"Bookings-Operations",sort:[{EventName:"asc"}]},a.sports.revenue={fields:[{field:"Wins",using:{sum:{cond:[{$eq:["$Result","W"]},1,0]}}},{field:"Losses",using:{sum:{cond:[{$eq:["$Result","L"]},1,0]}}},{field:"Ties",using:{sum:{cond:[{$eq:["$Result","T"]},1,0]}}},{field:"TicketRevenue",using:{sum:{add:["$Individual_Revenue","$Lounge_Revenue","$Group_Revenue","$Season_Revenue_New","$Season_Revenue_Hold","$Season_Revenue_Partial","$Season_Revenue_Renewal","$Suites_Revenue_Budget","$Suites_Revenue_Licenses_New","$Suites_Revenue_Licenses_Renewal","$Suites_Revenue_Single","$Suites_Revenue_SuitePass"]}}},{field:"SuiteRevenue",using:{sum:{add:["$Suites_Revenue_Budget","$Suites_Revenue_Licenses_New","$Suites_Revenue_Licenses_Renewal","$Suites_Revenue_Single","$Suites_Revenue_SuitePass"]}}}],by:["Team"],filters:{Type:"Actual"},dataset:"Sports-TicketSales",sort:[{Team:"asc"}]},a.sports.ticketRevenue={fields:[{field:"Season_Revenue",using:{sum:{add:["$Season_Revenue_Hold","$Season_Revenue_New","$Season_Revenue_Partial","$Season_Revenue_Renewal"]}}},{field:"Individual_Revenue",using:"sum"},{field:"Group_Revenue",using:"sum"},{field:"Lounge_Revenue",using:"sum"},{field:"Suite_Revenue",using:{sum:{add:["$Suites_Revenue_Budget","$Suites_Revenue_Licenses_New","$Suites_Revenue_Licenses_Renewal","$Suites_Revenue_Single","$Suites_Revenue_SuitePass"]}}}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.ticketAllocated={fields:[{field:"Season_Allocated",using:{sum:{add:["$Season_Allocated_Hold","$Season_Allocated_New","$Season_Allocated_Partial","$Season_Allocated_Renewal"]}}},{field:"Individual_Allocated",using:"sum"},{field:"Group_Allocated",using:"sum"},{field:"Lounge_Allocated",using:"sum"},{field:"Suite_Allocated",using:{sum:{add:["$Suites_Allocated_Budget","$Suites_Allocated_Licenses_New","$Suites_Allocated_Licenses_Renewal","$Suites_Allocated_Single","$Suites_Allocated_SuitePass"]}}}],by:["Type"],filters:{Type:"Actual"},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.ticketSold={fields:[{field:"Season_Sold",using:{sum:{add:["$Season_Sold_Hold","$Season_Sold_New","$Season_Sold_Partial","$Season_Sold_Renewal"]}}},{field:"Individual_Sold",using:"sum"},{field:"Group_Sold",using:"sum"},{field:"Lounge_Sold",using:"sum"},{field:"Suite_Sold",using:{sum:{add:["$Suites_Sold_Budget","$Suites_Sold_Licenses_New","$Suites_Sold_Licenses_Renewal","$Suites_Sold_Single","$Suites_Sold_SuitePass"]}}}],by:["Type"],filters:{Type:"Actual"},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.seasonRevenue={fields:[{field:"Season_Revenue_Total",using:{sum:{add:["$Season_Revenue_Renewal","$Season_Revenue_New","$Season_Revenue_Partial"]}}},{field:"Season_Revenue_Renewal",using:"sum"},{field:"Season_Revenue_New",using:"sum"},{field:"Season_Revenue_Partial",using:"sum"}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.seasonSold={fields:[{field:"Season_Sold_Total",using:{sum:{add:["$Season_Sold_Renewal","$Season_Sold_New","$Season_Sold_Partial"]}}},{field:"Season_Sold_Renewal",using:"sum"},{field:"Season_Sold_New",using:"sum"},{field:"Season_Sold_Partial",using:"sum"}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.seasonRevenuePerCap={fields:[{field:"Season_RevenuePerCap_Total",using:{avg:{add:["$Season_RevenuePerCap_Renewal","$Season_RevenuePerCap_New","$Season_RevenuePerCap_Partial"]}}},{field:"Season_RevenuePerCap_Renewal",using:"avg"},{field:"Season_RevenuePerCap_New",using:"avg"},{field:"Season_RevenuePerCap_Partial",using:"avg"}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.seasonMix={fields:[{field:"Season_Allocated_Total",using:{sum:{add:["$Season_Allocated_Renewal","$Season_Allocated_New","$Season_Allocated_Partial","$Season_Allocated_Hold"]}}},{field:"Season_Sold_Total",using:{sum:{add:["$Season_Sold_Renewal","$Season_Sold_New","$Season_Sold_Partial","$Season_Sold_Hold"]}}},{field:"Season_Sold_Renewal",using:"sum"},{field:"Season_Sold_New",using:"sum"},{field:"Season_Sold_Partial",using:"sum"},{field:"Season_Sold_Hold",using:"sum"}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.groupRevenue={fields:[{field:"Total_Revenue",using:{sum:{add:["$Group_Revenue","$Individual_Revenue","$Comp_Revenue"]}}},{field:"Group_Revenue",using:"sum"},{field:"Individual_Revenue",using:"sum"},{field:"Comp_Revenue",using:"sum"}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.groupSold={fields:[{field:"Total_Sold",using:{sum:{add:["$Group_Sold","$Individual_Sold","$Comp_Sold"]}}},{field:"Group_Sold",using:"sum"},{field:"Individual_Sold",using:"sum"},{field:"Comp_Sold",using:"sum"}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.groupRevenuePerCap={fields:[{field:"Total_RevenuePerCap",using:{avg:{add:["$Group_RevenuePerCap","$Individual_RevenuePerCap","$Comp_RevenuePerCap"]}}},{field:"Group_RevenuePerCap",using:"avg"},{field:"Individual_RevenuePerCap",using:"avg"},{field:"Comp_RevenuePerCap",using:"avg"}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.lounge={fields:[{field:"Lounge_Allocated",using:"sum"},{field:"Lounge_Revenue",using:"sum"},{field:"Lounge_Sold",using:"sum"},{field:"Lounge_RevenuePerCap",using:"avg"}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.suiteRevenue={fields:[{field:"Suites_Revenue_Total",using:{sum:{add:["$Suites_Revenue_Licenses_New","$Suites_Revenue_Licenses_Renewal","$Suites_Revenue_Single","$Suites_Revenue_SuitePass"]}}},{field:"Suites_Revenue_Licenses",using:{sum:{add:["$Suites_Revenue_Licenses_New","$Suites_Revenue_Licenses_Renewal"]}}},{field:"Suites_Revenue_Single",using:"sum"},{field:"Suites_Revenue_SuitePass",using:"sum"}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.unlicensedSuites={fields:[{field:"Suites_Sold_Available",using:{sum:{add:["$Suites_Allocated_Single","$Suites_Allocated_SuitePass","$Suites_Allocated_Budget"]}}},{field:"Suites_Sold_Single",using:"sum"},{field:"Suites_Sold_SuitePass",using:"sum"},{field:"Suites_Sold_Budget",using:"sum"}],by:["Type"],filters:{Type:"Actual"},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.averageSuite={fields:[{field:"Suites_Sold",using:{sum:{add:["$Suites_Sold_Budget","$Suites_Sold_Licenses_New","$Suites_Sold_Licenses_Renewal","$Suites_Sold_Single","$Suites_Sold_SuitePass"]}}},{field:"Suites_Revenue",using:{sum:{add:["$Suites_Revenue_Budget","$Suites_Revenue_Licenses_New","$Suites_Revenue_Licenses_Renewal","$Suites_Revenue_Single","$Suites_Revenue_SuitePass"]}}}],by:["Type"],filters:{},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.suiteMix={fields:[{field:"Suites_Sold_Licenses_Total",using:{sum:{add:["$Suites_Allocated_Licenses_New","$Suites_Allocated_Licenses_Renewal"]}}},{field:"Suites_Sold_Licenses_New",using:"sum"},{field:"Suites_Sold_Licenses_Renewal",using:"sum"}],by:["Type"],filters:{Type:"Actual"},dataset:"Sports-TicketSales",sort:[{Type:"asc"}]},a.sports.operationsAncillary={fields:[{field:"FoodBeverage",using:"sum"},{field:"FoodBeveragePerCap",using:"avg"},{field:"Merchandise",using:"sum"},{field:"MerchandisePerCap",using:"avg"}],by:["Grade"],filters:{Type:"Actual"},dataset:"Sports-Operations",sort:[{Grade:"asc"}]},a.sports.operationsStaffing={fields:[{field:"LaborCostPerAttendee_FoodBeverage",using:"avg"},{field:"LaborCostPerAttendee_Merchandise",using:"avg"},{field:"LaborCostPerAttendee_BoxOffice",using:"avg"},{field:"LaborCostPerAttendee_BuildingServices",using:"avg"},{field:"LaborCostPerAttendee_Security",using:"avg"},{field:"LaborCostPerAttendee_GuestRelations",using:"avg"},{field:"OvertimeCost_FoodBeverage",using:"sum"},{field:"OvertimeCost_Merchandise",using:"sum"},{field:"OvertimeCost_BoxOffice",using:"sum"},{field:"OvertimeCost_BuildingServices",using:"sum"},{field:"OvertimeCost_Security",using:"sum"},{field:"OvertimeCost_GuestRelations",using:"sum"},{field:"StaffingPerAttendee_FoodBeverage",using:"avg"},{field:"StaffingPerAttendee_Merchandise",using:"avg"},{field:"StaffingPerAttendee_BoxOffice",using:"avg"},{field:"StaffingPerAttendee_BuildingServices",using:"avg"},{field:"StaffingPerAttendee_Security",using:"avg"},{field:"StaffingPerAttendee_GuestRelations",using:"avg"}],by:["Type"],filters:{},dataset:"Sports-Operations"},a.sports.sponsorRevenue={fields:[{field:"Revenue",using:"sum"}],by:["Sponsor"],filters:{},dataset:"Sports-Sponsors",sort:[{Sponsor:"asc"}]},a.sports.sponsorActual={fields:[{field:"Revenue",using:"sum"}],by:["SponsorType"],filters:{},dataset:"Sports-Sponsors",sort:[{SponsorType:"asc"}]},a.sports.sponsorType={fields:[{field:"Budget",using:"sum"},{field:"PriorYear",using:"sum"}],by:["SponsorType"],filters:{},dataset:"Sports-SponsorBudget",sort:[{SponsorType:"asc"}]},a.eventDetails.ticket={fields:[{field:"Revenue",using:"sum"},{field:"Sold",using:"sum"},{field:"ProjectedContribution",using:"sum"},{field:"Capacity",using:"sum"},{field:"SuitesSold",using:"sum"},{field:"LicenseFee",using:"sum"},{field:"RevenuePerCap",using:"avg"},{field:"DiscountToFace",using:"avg"},{field:"SellThrough",using:"sum"},{field:"SuiteRevenue",using:"sum"},{field:"Total Revenue",using:"sum"},{field:"TotalSales",using:"sum"},{field:"Ticket Revenue",using:"sum"},{field:"count",using:{sum:1}},{field:"StartDate",using:{min:"$Date"}},{field:"EndDate",using:{max:"$Date"}}],by:["Type","Performance"],filters:{},dataset:"Bookings-TicketSales"},a.eventDetails.operations={fields:[{field:"FoodBeverage",using:"sum"},{field:"Merchandise",using:"sum"},{field:"LaborCost",using:{sum:{add:["$LaborCostPerAttendee_FoodBeverage","$LaborCostPerAttendee_Merchandise","$LaborCostPerAttendee_BoxOffice","$LaborCostPerAttendee_BuildingServices","$LaborCostPerAttendee_Security","$LaborCostPerAttendee_GuestRelations"]}}},{field:"StaffCost",using:{sum:{add:["$StaffingPerAttendee_FoodBeverage","$StaffingPerAttendee_Merchandise","$StaffingPerAttendee_BoxOffice","$StaffingPerAttendee_BuildingServices","$StaffingPerAttendee_Security","$StaffingPerAttendee_GuestRelations"]}}}],by:["Type"],filters:{},dataset:"Bookings-Operations"},a.eventDetails.sponsors={fields:[{field:"Revenue",using:"sum"},{field:"Budget",using:"sum"},{field:"PriorYear",using:"sum"}],by:["Type"],filters:{},dataset:"Bookings-Sponsors"},a.preload_images=["/images/logo.png"],a}]),angular.module("app").factory("common",["$state","$rootScope","$q","constants","DataDelegate",function(e,a,t,i,n){var o={};o.formatNumber=function(e,a){if(!e)return e;var t=1;(a||0===a)&&(t=a);var i=e;return i=Math.abs(e)>=1e6?(e/1e6).toFixed(t)+"M":Math.abs(e)>=1e3?(e/1e3).toFixed(t)+"k":e.toFixed(t)},o.formatPercentage=function(e,a){if(!e)return e;var t=1;return(a||0===a)&&(t=a),(100*e).toFixed(t)},o.format=function(e,a,t){return"#"===a?o.formatNumber(e,t):"%"===a?o.formatPercentage(e,t):void 0},o.formatDate=function(e,a){if(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"],i=e.slice(2,4),n=e.slice(4,6),o=e.slice(-2);return"0"===o.slice(0,1)&&(o=o.slice(-1)),n=t[parseInt(n)-1],a&&(n=n.slice(0,3),n=n.toUpperCase()),o+"."+n+"."+i}},o.GoToPage=function(a){return e.get(a)?e.go(a):!1},o.hasItem=function(e,a){return _.contains(a,e)},o.prepend=function(e){return 10>e?"0"+e:e.toString()},o.getToday=function(){var e=new Date,t=a.Season,i="";t||(t=a.Year),t?i=t._id.toString().substring(0,4):(t=a.FiscalYear,i=t._id.toString().substring(2,6));var n=e.getMonth()+1,s=e.getDate();return i+o.prepend(n)+o.prepend(s)},o.prepFilters=function(e){return _.each(_.where(a.filters,{active:!0}),function(t,i){return a[t.id].func?void(e=o[a[t.id].func](a[t.id],e)):void(a[t.id]._id.toString().indexOf("All")>-1?e.filters[t.id]=void 0:e.filters[t.id]=a[t.id]._id)}),e.fields.push({field:"LastUpdate",using:"first"}),e},o.calcRange=function(e,a){var t=o.getToday();switch(e._id){case 0:a.filters.Date=void 0;break;case 1:a.filters.Date={gt:t};break;case 2:a.filters.Date={lt:t};break;case 3:a.filters.Date={},moment(e.exactDate,"MM/DD/YYYY",!0).isValid()?a.filters.Date=e.exactDate.slice(6,10)+e.exactDate.slice(0,2)+e.exactDate.slice(3,5):(moment(e.fromDate,"MM/DD/YYYY",!0).isValid()&&(a.filters.Date.gte=e.fromDate.slice(6,10)+e.fromDate.slice(0,2)+e.fromDate.slice(3,5)),moment(e.toDate,"MM/DD/YYYY",!0).isValid()&&(a.filters.Date.lte=e.toDate.slice(6,10)+e.toDate.slice(0,2)+e.toDate.slice(3,5)))}return a},o.calcMonth=function(e,a){return a},o.calcYear=function(e,a){var t=a.filters.Date;return t&&t.gt&&(t.gt=e._id+t.gt.substr(4,2)+t.gt.substr(6,2)),t&&t.lt&&(t.lt=e._id+t.lt.substr(4,2)+t.lt.substr(6,2)),a},o.checkUndefined=function(e,a){return a?e&&e[a]?e[a]:0:e?e:0};var s=moment("19700101","YYYYMMDD");return o.getLastUpdated=function(e){var t="";e[0]&&e[0].LastUpdate&&(t=e[0].LastUpdate,t=moment(t,"YYYYMMDD"),(!a.setLastUpdated||s.diff(t,"days")<0)&&(s=t,a.updated="Data last updated on "+t.format("MMMM Do, YYYY"),a.setLastUpdated=!0))},o.getQueries=function(e,a,t){var s=[],r=o.prepFilters(e),l=_.cloneDeep(r),d=_.cloneDeep(r);if("A"===r.filters.Type?(l.filters.Type="B",d.filters.Type="C"):(l.filters.Type="Budget",d.filters.Type="PriorYear"),s.push(n[a]({params:{q:JSON.stringify(r)}})),s.push(n[a]({params:{q:JSON.stringify(l)}})),s.push(n[a]({params:{q:JSON.stringify(d)}})),"Type"!==e.by[0]){var c=_.cloneDeep(r);c.by[0]="Type",delete c.filters.Type,c.sort=[{Type:"asc"}],s.push(n[a]({params:{q:JSON.stringify(c)}}))}var u=!1;if(_.each(t,function(e){_.find(e,"uniqShow")&&(u=!0)}),u){var p=o.prepFilters(i.productions.uniqShows);s.push(n[a]({params:{q:JSON.stringify(p)}}))}return s},o.sortGrade=function(e){return _.sortBy(e.breakdown,function(e){return-1==e.name.indexOf("+")?e.name+"Z":e.name})},o.barPrep=function(e,a){e.breakdown=[],_.each(a,function(a,t){if(!(t>2)){var i=0;_.each(a.data,function(a){i+=o.checkUndefined(a,e.data)}),e.perShow?e.breakdown.push(o.checkUndefined(i/a.data.length)):e.breakdown.push(i)}})},o.columnPrep=function(e,a,t,i){e.breakdown=[],_.each(a[0].data,function(i,n){var s=0,r=0,l=o.checkUndefined(i[e.data]);if(i.Channel){if(a[1].data&&a[2].data||a[0].data.length!==a[1].data.length||a[0].data.length!==a[2].data.length||a[1].data.length!==a[2].data.length){var d=_.each(a[1].data,function(e){return e.Channel&&(e.Channel=e.Channel.toLowerCase()),e}),c=_.each(a[2].data,function(e){return e.Channel&&(e.Channel=e.Channel.toLowerCase()),e});s=o.checkUndefined(_.where(d,{Channel:i.Channel.toLowerCase()})[0],e.data),r=o.checkUndefined(_.where(c,{Channel:i.Channel.toLowerCase()})[0],e.data)}}else s=o.checkUndefined(a[1].data[n],e.data),r=o.checkUndefined(a[2].data[n],e.data);e.uniqShow&&(l/=_.where(a[4].data,function(e){return e[t]===i[t]&&"Actual"===e.Type}).length,s/=_.where(a[4].data,function(e){return e[t]===i[t]&&"Budget"===e.Type}).length,r/=_.where(a[4].data,function(e){return e[t]===i[t]&&"PriorYear"===e.Type}).length),e.breakdown.push({name:i[t],actual:l,budget:s,prior:r})}),i&&(e.breakdown=o[i](e));var n=_.remove(e.breakdown,function(e){return"Box Office"===e.name});n.length>0&&e.breakdown.push(n[0]),e.total[0].actual=o.checkUndefined(a[3].data[0],e.data),e.total[0].budget=o.checkUndefined(a[3].data[1],e.data),e.total[0].prior=o.checkUndefined(a[3].data[2],e.data),e.uniqShow&&(e.total[0].actual=e.total[0].actual/_.where(a[4].data,function(e){return"Actual"===e.Type}).length,e.total[0].budget=e.total[0].budget/_.where(a[4].data,function(e){return"Budget"===e.Type}).length,e.total[0].prior=e.total[0].prior/_.where(a[4].data,function(e){return"PriorYear"===e.Type}).length)},o.mixPrep=function(e,a){var t=_.reduce(a[0].data,function(e,a){return e+a.Sold},0),i=_.reduce(a[1].data,function(e,a){return e+a.Sold},0),n=_.reduce(a[2].data,function(e,a){return e+a.Sold},0),s=["brokers","non-broker groups","flash","individual discount","individual full price"];_.each(s,function(s,r){e.breakdown[0][s]=o.checkUndefined(_.find(a[0].data,function(e){return e.Channel.toLowerCase()===s}),"Sold")/t*100,e.breakdown[1][s]=o.checkUndefined(_.find(a[2].data,function(e){return e.Channel.toLowerCase()===s}),"Sold")/n*100,e.breakdown[2][s]=o.checkUndefined(_.find(a[1].data,function(e){return e.Channel.toLowerCase()===s}),"Sold")/i*100})},o.getData=function(e,a,i,n,s){s=s?s:"getWallaceData",t.all(o.getQueries(a,s,e)).then(function(a){o.getLastUpdated(a[0].data),_.each(e,function(e){e[0].temp===!0&&(_.each(a[0].data,function(a,t){var n={title:a[i],type:e[0].type,data:e[0].data,unit:e[0].unit,format:e[0].format,breakdown:[]};e.push(n)}),e.shift()),_.each(e,function(e){e.perShow||o[e.type+"Prep"](e,a,i,n)})}),setTimeout(function(){$('[data-toggle="popover"]').popover()},300)})},o.getDataStaffing=function(e,a,t){n.getWallaceData({params:{q:JSON.stringify(o.prepFilters(a))}}).then(function(a){var i=_.where(a.data,{Type:"Actual"})[0],n=_.where(a.data,{Type:"Budget"})[0],s=_.where(a.data,{Type:"PriorYear"})[0];_.each(e,function(e){var a={actual:0,budget:0,prior:0};e.breakdown=[],e.total[0].actual=0,e.total[0].budget=0,e.total[0].prior=0,_.each(t,function(t){var r=o.checkUndefined(i,e.data+t.id),l=o.checkUndefined(n,e.data+t.id),d=o.checkUndefined(s,e.data+t.id);e.breakdown.push({name:t.name,actual:r,budget:l,prior:d}),e.total[0].actual+=r,e.total[0].budget+=l,e.total[0].prior+=d,t.FOH&&(a.actual+=r,a.budget+=l,a.prior+=d)})}),setTimeout(function(){$('[data-toggle="popover"]').popover()},300)})},o.getDataSponsorships=function(e,a){var i=o.prepFilters(e[0]),s=o.prepFilters(e[1]),r=o.prepFilters(e[2]);t.all([n.getWallaceData({params:{q:JSON.stringify(i)}}),n.getWallaceData({params:{q:JSON.stringify(s)}}),n.getWallaceData({params:{q:JSON.stringify(r)}})]).then(function(e){o.getLastUpdated(e[0].data),a.pieDataActual=[],a.pieDataBudget=[],a.pieDataPrior=[],a.revenueBreakdown=[];var t=_.sortBy(e[0].data,function(e){return e.Revenue});t.length>5&&(t=t.slice(t.length-5,t.length)),_.each(t,function(e){a.revenueBreakdown.push({name:e.Sponsor,actual:e.Revenue})});var i=0,n=0,s=0;_.each(e[1].data,function(e){n+=e.Budget,s+=e.PriorYear,a.pieDataBudget.push(e.Budget),a.pieDataPrior.push(e.PriorYear)}),_.each(e[2].data,function(e){i+=e.Revenue,a.pieDataActual.push(e.Revenue)}),a.revenueTotal=[{name:"Total",actual:i,budget:n,prior:s}],a.sponsors=[e[0].data.length],a.dealSize=[i/e[0].data.length],setTimeout(function(){$('[data-toggle="popover"]').popover()},300)})},o.getOperationData=function(e,a,i,n,s){s=s?s:"getWallaceData",t.all(o.getQueries(a,s)).then(function(a){o.getLastUpdated(a[0].data),_.each(e,function(e){e[0].temp===!0&&(_.each(a[0].data,function(a,t){var n={title:a[i],type:e[0].type,data:e[0].data,unit:e[0].unit,format:e[0].format,breakdown:[]};e.push(n)}),e.shift()),o.getUpdatedOperationData(e[2],a).then(function(){_.each(e,function(e){o[e.type+"Prep"](e,a,i,n)})})}),setTimeout(function(){$('[data-toggle="popover"]').popover()},300)})},o.getUpdatedOperationData=function(e,a){var s=t.defer(),r=[{id:"FoodBeverage",name:"Food & Beverage"},{id:"Merchandise",name:"Merchandise"},{id:"Security",name:"Security",FOH:!0},{id:"GuestRelations",name:"Guest Relations",FOH:!0},{id:"BoxOffice",name:"Ticket Ops (Box Office)",FOH:!0},{id:"BuildingServices",name:"Building Services",FOH:!0}];return n.getWallaceData({params:{q:JSON.stringify(o.prepFilters(i.productions.operationsStaffing))}}).then(function(t){if(t){var i=0,n=0,l=0,d=_.where(t.data,{Type:"Actual"})[0],c=_.where(t.data,{Type:"Budget"})[0],u=_.where(t.data,{Type:"PriorYear"})[0],p=e.data+"_";_.each(r,function(e){var a=o.checkUndefined(d,p+e.id),t=o.checkUndefined(c,p+e.id),s=o.checkUndefined(u,p+e.id);
i+=a,n+=t,l+=s}),_.each(a,function(e){_.where(e.data,{Type:"Actual"}).length>0?e.data[0].LaborCostPerAttendee=i:_.where(e.data,{Type:"Budget"}).length>0?e.data[0].LaborCostPerAttendee=n:_.where(e.data,{Type:"PriorYear"}).length>0&&(e.data[0].LaborCostPerAttendee=l)}),s.resolve(a)}else s.deferred.reject()}),s.promise},o.getSingleData=function(e,a,i,n,s){s=s?s:"getWallaceData",t.all(o.getQueries(a,s)).then(function(a){o[e.type+"Prep"](e,a,i,n)})},o.setTimeSlot=function(e,o,s){var r=t.defer(),l=_.find(a.filters,{id:"TimeSlot"});if(l&&(l.active=!0,l.query)){if(moment(e,"MM/DD/YYYY",!0).isValid())var d=e.slice(6,10)+e.slice(0,2)+e.slice(3,5);if(moment(o,"MM/DD/YYYY",!0).isValid())var c=e.slice(6,10)+o.slice(0,2)+o.slice(3,5);i.queryMatchTimeSlot.aggregate[0].$match.Date.$lte=c,i.queryMatchTimeSlot.aggregate[0].$match.Date.$gte=d,l.query=i.queryMatchTimeSlot,l.query.dataset=s,n.getWallaceData({params:{q:JSON.stringify(l.query)}}).then(function(e){e&&e.data.length>=0?r.resolve(e):r.deferred.reject()})}return r.promise},o}]),angular.module("app").factory("cache",["toaster",function(e){var a={};return a.toast=function(a,t,i){_.isUndefined(i)&&(i="success"),e.pop(i,a,t)},a}]),angular.module("app").controller("headerCtrl",["$scope","$rootScope","$q","constants","common","DataDelegate",function(e,a,t,i,n,o){e.heatmaps=[{name:"Number of events",math:"count",format:"#",title:"Number of Events by Event Type and Venue",header:"Count"},{name:"Tickets Sold",math:"sum",format:"#",attr:"Sold",title:"Tickets Sold by Event Type and Venue",header:"Sold"},{name:"Sell-Through",math:"avg",format:"%",attr:"SellThrough",title:"Sell-Through % by Event Type and Venue",header:"Sell-Thru %"},{name:"Avg Event Revenue",math:"avg",format:"#",attr:"Revenue",title:"Average Event Revenue by Event Type and Venue",header:"Revenue"}],a.heatmap=e.heatmaps[0],e.Ranges=[{_id:0,name:"Full Season",func:"calcRange"},{_id:1,name:"Remaining Performances",func:"calcRange"},{_id:2,name:"Performances to Date",func:"calcRange"},{_id:3,name:"Custom Range",func:"calcRange"}],a.Range=e.Ranges[0];var s=a.Range;e.Teams=[{_id:"All"},{_id:"Knicks",img:"knicks_logo.png"},{_id:"Rangers",img:"rangers_logo.png"},{_id:"Liberty",img:"liberty_logo.png"},{_id:"Westchester Knicks",img:"westchester-knicks_logo.png"}],a.Team=e.Teams[0],e.Months=[{_id:"00",name:"All Months",func:"calcMonth"},{_id:"01",name:"January",func:"calcMonth"},{_id:"02",name:"February",func:"calcMonth"},{_id:"03",name:"March",func:"calcMonth"},{_id:"04",name:"April",func:"calcMonth"},{_id:"05",name:"May",func:"calcMonth"},{_id:"06",name:"June",func:"calcMonth"},{_id:"07",name:"July",func:"calcMonth"},{_id:"08",name:"August",func:"calcMonth"},{_id:"09",name:"September",func:"calcMonth"},{_id:"10",name:"October",func:"calcMonth"},{_id:"11",name:"November",func:"calcMonth"},{_id:"12",name:"December",func:"calcMonth"}],a.Month=e.Months[0],a.prepHeader=function(s,d,c,u){a.setLastUpdated=!1,e.headerClass=d,e.breadcrumb=u,e.common=n,a.filters=[{id:"ShowName",query:i.queryShow},{id:"Season",query:i.querySeason,func:"seasonPrep"},{id:"Team"},{id:"Range"},{id:"TimeSlot",query:i.queryTimeSlot,all:"All Times",func:"timePrep"},{id:"Venue",query:i.queryVenue,all:"All Venues"},{id:"EventName",query:i.queryEvent,all:"All Events"},{id:"Deal",query:i.queryDeal,all:"All Deals"},{id:"Year",query:i.queryYear,func:"yearPrep"},{id:"FiscalYear",query:i.queryFiscalYear},{id:"Month"}];var p=[];_.each(c,function(e){var t=_.find(a.filters,{id:e});t&&(t.active=!0,t.query&&(t.query.dataset=s,p.push(o.getWallaceData({params:{q:JSON.stringify(t.query)}}))))}),t.all(p).then(function(t){var i=_.where(a.filters,function(e){return e.active&&e.query});_.each(i,function(a,i){a.func?e[a.func](t[i].data):e[a.id+"s"]=t[i].data,a.all&&e[a.id+"s"].splice(0,0,{_id:a.all}),r(a)}),a.headerReady=!0,l(),a.$broadcast("init")}),"productions"===d?(e.Ranges[0].name="Full Season",e.Ranges[1].name="Remaining Performances",e.Ranges[2].name="Performances to Date"):"bookings"===d?(e.Ranges[0].name="Full Year",e.Ranges[1].name="Future Events",e.Ranges[2].name="Past Events"):"sports"===d&&(e.Ranges[0].name="All Games",e.Ranges[1].name="Upcoming Games",e.Ranges[2].name="Completed Games")};var r=function(t){a[t.id]&&_.find(e[t.id+"s"],{_id:a[t.id]._id})?a[t.id]=_.find(e[t.id+"s"],{_id:a[t.id]._id}):a[t.id]=e[t.id+"s"][0]},l=function(){a.stickyCalendar&&(_.each(a.stickyCalendar,function(t){a[t.id]=_.find(e[t.id+"s"],{_id:t.val})}),a.stickyCalendar=!1)};e.timePrep=function(a){e.TimeSlots=a,e.TimeSlots.sort(function(e,a){return new Date("1970/01/01 "+e._id)-new Date("1970/01/01 "+a._id)})},e.seasonPrep=function(a){e.Seasons=a,e.Seasons.sort(function(e,a){return a._id-e._id})},e.yearPrep=function(a){e.Years=[],_.each(a,function(a){e.Years.push({_id:a.year,func:"calcYear"})})},a.setClass=function(a){e.headerClass=a},e.teamClick=function(t){a.Team=t,e.init()},e.showFilter=function(e){return _.result(_.find(a.filters,{id:e}),"active")},e.selectRange=function(){3==a.Range._id?e.showDatepicker=!0:(s=a.Range,d(),e.init())},e.cancelDate=function(){d(),a.Range=s},a.resetRange=function(){a.Range=e.Ranges[0],d()};var d=function(){e.showDatepicker=!1,e.fromDate="",e.toDate="",e.Ranges[3].name="Custom Range"};e.saveDate=function(){e.showDatepicker=!1,a.selectCustomRange(),e.init()},a.selectCustomRange=function(t){var i="";t?(a.Range=e.Ranges[3],a.Range.name="Custom: "+t,a.Range.exactDate=t):(a.Range.exactDate=!1,t=e.fromDate,i=e.toDate,a.Range.name="Custom: "+t.slice(0,5)+" - "+i.slice(0,5),a.Range.fromDate=t,a.Range.toDate=i),s=a.Range},e.changeHeatmap=function(){a.$broadcast("heatmapTypeChange")},e.init=function(){a.$broadcast("init")},e.setTimeSlotFilter=function(t){var i=_.where(a.filters,{id:"TimeSlot"},function(e){return e.active&&e.query});i[0].func?e[i[0].func](t):e[i[0].id+"s"]=t,i[0].all&&e[i[0].id+"s"].splice(0,0,{_id:i[0].all}),r(i[0]),a.headerReady=!0,l()},setTimeout(function(){$("#from").datepicker({onClose:function(e){$("#to").datepicker("option","minDate",e)}}),$("#to").datepicker({defaultDate:"+1w",onClose:function(e){$("#from").datepicker("option","maxDate",e)}})},300)}]),angular.module("app").run(["$templateCache",function(e){e.put("views/landing.html",'<div id="landing"><div class="container-fluid main"><div class="row" ng-click="common.GoToPage(\'productions\')"><div class="col-md-12"><div class="outer"><div class="bw"></div><span>Productions</span></div></div></div><div class="row" ng-click="common.GoToPage(\'bookings\')"><div class="col-md-12"><div class="outer"><div class="bw"></div><span>MSG Live</span></div></div></div><div class="row" ng-click="common.GoToPage(\'sports\')"><div class="col-md-12"><div class="outer"><div class="bw"></div><span>Sports</span></div></div></div></div></div>'),e.put("views/directives/bar-dir.html",'<div class="bar"><div class="budget" ng-style="{\'width\' : calcPos(data[1])+\'%\'}"></div><div class="actual" ng-style="{\'width\' : calcPos(data[0])+\'%\'}"></div><div class="budget" ng-style="{\'opacity\' : data[0] > data[1] ? 1 : 0, \'width\' : calcPos(data[1])+\'%\'}"></div><div class="values" ng-style="{\'opacity\' : data[0] || data[1] ? 1 : 0}"><span class="left">{{common.format(getLower(data), format, decimal)}}</span> <span ng-style="{\'right\' : getBiggerPos(data)+\'%\'}">{{common.format(getBigger(data), format, decimal)}}</span></div><div ng-style="{\'opacity\' : data[0] ? 1 : 0}" class="max" ng-show="max && max > getBigger(data)"></div><div class="previous" ng-show="data[2] === 0 || data[2]" ng-class="{animate: format, circle: shape == \'circle\'}" ng-style="{ \'left\' : calcPos(data[2])+\'%\'}"><span></span> {{common.format(data[2], format, decimal)}}</div></div>'),e.put("views/directives/bar-mixed-dir.html",'<div class="bar mixed"><div ng-repeat="n in data track by $index" ng-style="{\'width\' : calcPos(n), \'background-color\' : colors[$index]}" ng-show="n">{{common.format(n, format)}}</div></div>'),e.put("views/sports/calendar-template.html",'<div class="dayTile dayTileDetail" ng-class="detailDay.PerformanceCategory" ng-style="{display: (detailDay.show), left:(detailDay.xPosition + \'px\'), top:(detailDay.yPosition + \'px\')}"><div ng-click="closeTileDetail($event)" id="sportsPopUpCloseButton">x</div><div id="event-name" ng-click="goToFilteredCalendar(detailDay,\'sportsTickets\')">{{detailDay.Team}} vs {{detailDay.Opponent}} &#40;{{detailDay.Result}}&#41;</div><div id="event-details"><div id="venue-name">{{detailDay.Venue}}</div><div id="event-date">{{detailDay.date}} | {{detailDay.Time}}</div></div></div><div class="daysOfSeason"><div id="main-calendar"><div class="calendar-week" ng-repeat="week in calendar"><div class="dayTile" ng-repeat="day in week"><div class="dayLabel">{{day.dayOfWeek}} {{day.dayOfMonth}}</div><span class="games"><span class="game" ng-click="showTileDetail(game, $event, day)" ng-repeat="game in day.events"><span class="result" ng-class="game.PerformanceCategory"></span><span class="venue">vs {{game.Opponent}} &#40;{{game.Result}}&#41;</span></span></span></div></div></div></div>'),e.put("views/sports/calendar.html",'<div id="sportsCalendar"><div class="container calendar-view"><div class="season-range"><span ng-if="calendarStart !=\'\'">{{calendarStart}} &#45; {{calendarEnd}}</span>&nbsp;</div><ul class="legend pull-right"><popover-dir class="infocalendar" info="“High performing performances have revenues above the budget for the performance. “Within range” indicates a performance’s revenues are at or above the revenues for the equivalent performance last year as of this date. “Low performing” performances have revenues that are at least 75% of the revenues for the equivalent performance last year as of this date, but below 100% of last year’s revenues. “At risk” performances have revenue that is less than 75% of the revenue for the equivalent performance last year as of this date"></popover-dir><li><span class="high-performing"></span>Outperforming</li><li><span class="on-track"></span>On Track</li><li><span class="low-performing"></span>Low Performing</li><li><span class="at-risk"></span>At Risk</li></ul><msg-calendar module="sports" placement="calendar-page"></msg-calendar></div></div>'),e.put("views/sports/dashboard.html",'<div class="sports dashboard"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row"><div class="col-md-4"><h1 ng-click="common.GoToPage(\'sportsTickets\')">Ticket Sales &amp; Sponsorship &gt;</h1><div><div class="info infodash" ng-show="sports[0].info" data-toggle="popover" data-content="{{sports[0].info}}">i</div><div ng-click="common.GoToPage(\'sportsTickets\')"><h4>{{sports[0].title}} <span>$M</span></h4><div class="col-md-6 no-padding"><div column="" data="sports.allSports.total" format="sports.allSports.format" height="300"></div><div class="subtitle">All Sports Teams<br>Ticket &amp; Suite Revenue</div></div><div class="col-md-6 no-padding"><div column="" data="sports.suites.total" format="sports.suites.format" height="300"></div><div class="subtitle"><img src="images/msgSuites_logo.png"></div></div></div></div></div><div class="col-md-8"><div class="border"></div><h1>&nbsp;</h1><div class="info infosports" ng-show="sports[1].info" data-toggle="popover" data-content="{{sports[1].info}}">i</div><div ng-click="common.GoToPage(\'sportsTickets\')"><h4>{{sports[1].title}}<span>$M</span><p>W-L</p></h4><div ng-repeat="graph in sports.sportGraphs" class="sport-teams"><div><img ng-src="images/{{graph.img}}"></div><div><div bar="" data="graph.breakdown" format="graph.format"></div></div><div>{{graph.win}}&#8211;{{graph.loss}}</div></div></div></div></div></div></div><div id="sportsCalendar"><div class="container calendar-view"><h1>Upcoming Performances <span ng-click="common.GoToPage(calendar.url)">Full calendar ></span></h1><ul class="legend pull-right"><popover-dir class="infocalendar" info="“High performing performances have revenues above the budget for the performance. “Within range” indicates a performance’s revenues are at or above the revenues for the equivalent performance last year as of this date. “Low performing” performances have revenues that are at least 75% of the revenues for the equivalent performance last year as of this date, but below 100% of last year’s revenues. “At risk” performances have revenue that is less than 75% of the revenue for the equivalent performance last year as of this date"></popover-dir><li><span class="high-performing"></span>Outperforming</li><li><span class="on-track"></span>On Track</li><li><span class="low-performing"></span>Low Performing</li><li><span class="at-risk"></span>At Risk</li></ul><msg-calendar module="sports" placement="dashboard-page"></msg-calendar></div></div></div>'),e.put("views/sports/operations.html",'<div class="sports"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li ng-click="common.GoToPage(\'sportsTickets\')">Ticket Sales</li><li class="active" ng-click="common.GoToPage(\'sportsOperations\')">Operations</li><li ng-click="common.GoToPage(\'sportsSponsorships\')">Sponsorships</li></ul><ul class="anchor-menu pull-right"><li ng-click="scrollTo(\'ancillary\')">Ancillary</li><li ng-click="scrollTo(\'staffing\')">Staffing</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><h2 id="ancillary">Ancillary</h2><div class="row" ng-repeat="chart in chartsAncillary"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format" decimal="chart.decimal"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format" decimal="chart.decimal"></div></div></div></div><h2 id="staffing">Staffing</h2><div class="row" ng-repeat="chart in chartsStaffing"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format"></div><div class="front"><span></span> <span>Front of House</span> <span></span></div></div></div></div></div></div></div>'),e.put("views/sports/sponsorships.html",'<div class="sports"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li ng-click="common.GoToPage(\'sportsTickets\')">Ticket Sales</li><li ng-click="common.GoToPage(\'sportsOperations\')">Operations</li><li class="active" ng-click="common.GoToPage(\'sportsSponsorships\')">Sponsorships</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row"><div class="col-md-12"><h4>Sponsorship Revenues<span>&#40;$&#41;</span></h4><div class="col-md-2"><div column="" data="sponsor.revenueTotal" format="\'#\'"></div></div><div class="col-md-10"><div column="" data="sponsor.revenueBreakdown" format="\'#\'"></div></div></div></div><div class="row"><div class="col-md-12 mix"><h4>Sponsorship Revenue Mix<span>&#40;$&#41;</span></h4><ul class="legend-mix pie pull-right"><li><span></span>Contracted</li><li><span></span>Renewals</li><li><span></span>New business</li></ul></div></div><div class="row pie"><div class="col-md-4"><div pie="" data="sponsor.pieDataActual" format="\'#\'"></div><span>Actual</span></div><div class="col-md-4"><div pie="" data="sponsor.pieDataBudget" format="\'#\'"></div><span>Budget</span></div><div class="col-md-4"><div pie="" data="sponsor.pieDataPrior" format="\'#\'"></div><span>Previous Year</span></div></div><div class="row"><div class="col-md-12"><h4>Sponsors <span>&#40;Count&#41;</span></h4><div bar="" data="sponsor.sponsors" format="\'#\'" decimal="0"></div></div></div><div class="row"><div class="col-md-12"><h4>Average Deal Size <span>&#40;$&#41;</span></h4><div bar="" data="sponsor.dealSize" format="\'#\'"></div></div></div><div class="bump"></div></div></div></div>'),e.put("views/sports/tickets.html",'<div class="sports"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li class="active" ng-click="common.GoToPage(\'sportsTickets\')">Ticket Sales</li><li ng-click="common.GoToPage(\'sportsOperations\')">Operations</li><li ng-click="common.GoToPage(\'sportsSponsorships\')">Sponsorships</li></ul><ul class="anchor-menu pull-right"><li ng-click="scrollTo(\'overview\')">Overview</li><li ng-click="scrollTo(\'season\')">Season Tickets</li><li ng-click="scrollTo(\'individual\')">Individual, Group &amp; Lounge Ticket Sales</li><li ng-click="scrollTo(\'suites\')">Suites</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><h2 id="overview">Overview</h2><div class="row"><div class="col-md-12"><div class="info" data-toggle="popover" data-content="{{chartRevenue.info}}">i</div><h4>Total Revenue by Inventory Type<span>&#40;$&#41;</span></h4><div class="col-md-2"><div column="" data="chartRevenue.total" format="\'#\'"></div></div><div class="col-md-10"><div column="" data="chartRevenue.breakdown" format="\'#\'"></div></div></div></div><div class="row"><div class="col-md-12 mix"><h4>Total Tickets Sold Mix<span>&#40;Count&#41;</span></h4><ul class="legend-mix pull-right"><li><span style="background-color: #336080"></span>Season</li><li><span style="background-color: #f68428"></span>Individual</li><li><span style="background-color: #4d4d4d"></span>Group</li><li><span style="background-color: #50909a"></span>Lounges</li><li><span style="background-color: #0068b3"></span>Suites</li></ul></div></div><div class="row"><div class="col-md-12"><div class="info" ng-show="totalTicketsNumber[0].info" data-toggle="popover" data-content="{{totalTicketsNumber[0].info}}">i</div><h4>{{totalTicketsNumber[0].title}}</h4><div bar-mixed="" data="soldMix.allocated" format="\'#\'" colors="soldMix.soldColors"></div></div></div><div class="row"><div class="col-md-12"><h4>Number of Tickets Sold</h4><div bar-mixed="" data="soldMix.sold" format="\'#\'" colors="soldMix.soldColors"></div></div></div><div class="row"><div class="col-md-12"><div class="info" ng-show="totalTicketsNumber[1].info" data-toggle="popover" data-content="{{totalTicketsNumber[1].info}}">i</div><h4>{{totalTicketsNumber[1].title}}</h4><div bar-mixed="" data="soldMix.available" format="\'#\'" colors="soldMix.soldColors"></div></div></div><div class="small-bump"></div><h2 id="season">Season Tickets</h2><div class="row" ng-repeat="chart in seasonCharts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.caption}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="\'#\'"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="\'#\'"></div></div></div></div><div class="row"><div class="col-md-12 mix"><h4>Ticket Sales Mix<span>&#40;Number of full-season equivalents&#41;</span></h4><ul class="legend-mix pull-right"><li><span style="background-color: #336080"></span>Renewals</li><li><span style="background-color: #4d4d4d"></span>New Fulls</li><li><span style="background-color: #50909a"></span>Partials</li><li><span style="background-color: #0068b3"></span>Holds</li><li><span style="background-color: #84ccac"></span>Available</li></ul></div></div><div class="row" ng-repeat="chart in seasonMix"><div class="col-md-12"><h4>{{chart.title}}</h4><div bar-mixed="" data="chart.data" format="\'#\'" colors="chart.colors"></div></div></div><div class="small-bump"></div><h2 id="individual">Individual, Group &amp; Lounge Ticket Sales</h2><div class="row" ng-repeat="chart in groupCharts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.caption}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="\'#\'"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="\'#\'"></div></div></div></div><div class="row" ng-repeat="chart in loungeCharts"><div class="col-md-12"><h4>{{chart.title}}<span>&#40;{{chart.caption}}&#41;</span></h4><div bar="" data="chart.breakdown" format="\'#\'" max="chart.max"></div></div></div><div class="small-bump"></div><h2 id="suites">Suites</h2><div class="row" ng-repeat="chart in suiteCharts"><div class="col-md-12"><h4>{{chart.title}}<span>&#40;{{chart.caption}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="\'#\'"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="\'#\'"></div></div></div></div><div class="row"><div class="col-md-12 mix single"><h4>Number of Unlicensed Suites Sold</h4><ul class="legend-mix pull-right"><li><span style="background-color: #336080"></span>Single Night Rentals</li><li><span style="background-color: #4d4d4d"></span>Suite Passes</li><li><span style="background-color: #50909a"></span>Budget</li><li><span style="background-color: #84ccac"></span>Available</li></ul></div></div><div class="row"><div class="col-md-12"><div bar-mixed="" data="unlicensedSuites.data" format="\'#\'" colors="unlicensedSuites.colors"></div></div></div><div class="row"><div class="col-md-12"><h4>Average Revenue per Suite<span>&#40;$&#41;</span></h4><div bar="" data="avgSuite.data" format="\'#\'"></div></div></div><div class="row"><div class="col-md-12 mix single"><h4>Suite License Mix</h4><ul class="legend-mix pull-right"><li><span style="background-color: #336080"></span>Renewals</li><li><span style="background-color: #4d4d4d"></span>New Sales</li><li><span style="background-color: #84ccac"></span>Available</li></ul></div></div><div class="row"><div class="col-md-12"><div bar-mixed="" data="renewalSuites.data" format="\'#\'" colors="renewalSuites.colors"></div></div></div></div></div></div>'),e.put("views/bookings/calendar-template.html",'<div class="dayTile dayTileDetail" ng-style="{display: (detailDay.show), left:(detailDay.xPosition + \'px\'), top:(detailDay.yPosition + \'px\')}" ng-class="detailDay.PerformanceCategory"><div ng-click="closeTileDetail($event)" id="bookingsPopUpCloseButton">x</div><div id="event-name" ng-click="goToDetail(detailDay)">{{detailDay.Event}}</div><div id="event-details" ng-click="goToDetail(detailDay)"><div id="venue-name">{{detailDay.Venue}}</div><div id="event-date">{{detailDay.date}} | {{detailDay.TimeSlot}}</div></div></div><div class="daysOfSeason"><div id="main-calendar"><div class="calendar-week" ng-repeat="week in calendar"><div class="dayTile" ng-repeat="day in week"><div class="dayLabel">{{day.dayOfWeek}} {{day.dayOfMonth}}</div><span class="shows"><span class="show" ng-click="showTileDetail(show, $event, day)" ng-repeat="show in day.events"><span class="performance" ng-class="show.PerformanceCategory">{{show.VenueCode}}</span> <span class="venue">{{show.Event}}</span></span></span></div></div></div></div>'),e.put("views/bookings/calendar.html",'<div id="bookingsCalendar"><div class="container calendar-view"><div class="season-range"><span ng-show="calendarStart !=\'\'">{{calendarStart}} &#45; {{calendarEnd}}</span>&nbsp;</div><ul class="legend pull-right"><popover-dir class="infocalendar" info="“High performing performances have revenues above the budget for the performance. “Within range” indicates a performance’s revenues are at or above the revenues for the equivalent performance last year as of this date. “Low performing” performances have revenues that are at least 75% of the revenues for the equivalent performance last year as of this date, but below 100% of last year’s revenues. “At risk” performances have revenue that is less than 75% of the revenue for the equivalent performance last year as of this date"></popover-dir><li><span></span>Outperforming</li><li><span></span>Within Range</li><li><span></span>Low Performing</li><li><span></span>At Risk</li><li><span></span>Dark Day</li></ul><msg-calendar module="bookings" placement="calendar-page"></msg-calendar></div></div>'),e.put("views/bookings/dashboard.html",'<div class="dashboard"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li><li><span></span>Show budget</li></ul></div></div><div class="row"><div class="col-md-6"><h1 ng-click="common.GoToPage(charts[0].url)">{{charts[0].title}} &gt;</h1><div ng-repeat="graph in charts[0].graphs"><div class="info infodash" ng-show="graph.info" data-toggle="popover" data-content="{{graph.info}}">i</div><div ng-click="common.GoToPage(charts[0].url)"><h4>{{graph.title}} <span>&#40;{{graph.unit}}&#41;</span></h4><div bar="" data="graph.breakdown" format="graph.format" shape="\'circle\'"></div></div></div></div><div class="col-md-6"><h1 ng-click="common.GoToPage(charts[1].url)">{{charts[1].title}} &gt;</h1><div ng-repeat="graph in charts[1].graphs"><div class="info infodash" ng-show="graph.info" data-toggle="popover" data-content="{{graph.info}}">i</div><div ng-click="common.GoToPage(charts[1].url)"><h4>{{graph.title}} <span>&#40;{{graph.unit}}&#41;</span></h4><div column="" data="graph.breakdown" format="graph.format" decimal="0"></div></div></div></div></div></div></div><div id="bookingsCalendar"><div class="container calendar-view"><h1>Upcoming Events <span ng-click="common.GoToPage(calendar.url)">Full calendar ></span></h1><div><ul class="legend pull-right"><popover-dir class="infocalendar" info="“High performing performances have revenues above the budget for the performance. “Within range” indicates a performance’s revenues are at or above the revenues for the equivalent performance last year as of this date. “Low performing” performances have revenues that are at least 75% of the revenues for the equivalent performance last year as of this date, but below 100% of last year’s revenues. “At risk” performances have revenue that is less than 75% of the revenue for the equivalent performance last year as of this date"></popover-dir><li><span></span>Outperforming</li><li><span></span>Within Range</li><li><span></span>Low Performing</li><li><span class="at-risk"></span>At Risk</li><li><span></span>Dark Day</li></ul><msg-calendar module="bookings" placement="dashboard-page"></msg-calendar></div></div></div></div>'),e.put("views/bookings/event-detail.html",'<div id="bookings-event-detail" class="event-details"><div class="container content"><div id="event-details"><div id="event-name">{{detailDay.Event}}</div><div id="venue-name">{{detailDay.Venue}} - <span id="event-performances">{{detailResponse.count}} {{detailResponse.countText}}</span> <span id="event-date">({{common.formatDate(detailResponse.StartDate, true)}}&nbsp;&nbsp;-&nbsp;&nbsp;{{common.formatDate(detailResponse.EndDate, true)}})</span></div></div><div id="box-metrics"><div id="str-group" class="box-metric"><div id="str-value" class="box-metric-value">{{common.format(detailResponse.SellThrough, \'%\', 0)}}</div><div id="str-label" class="box-metric-label">Average Sell-Through Rate (%)</div></div><div id="rev-group" class="box-metric"><div id="rev-value" class="box-metric-value">{{common.format(detailResponse.Revenue, \'#\', 0)}}</div><div id="rev-label" class="box-metric-label">Total Revenue ($M)</div></div><div id="cxn-group" class="box-metric"><div id="cxn-value" class="box-metric-value">{{common.format(detailResponse.ProjectedContribution, \'#\', 0)}}</div><div id="cxn-label" class="box-metric-label">Projected Contribution ($M)</div></div><div id="ctk-group" class="box-metric"><div id="ctk-value" class="box-metric-value">{{common.format(detailResponse.ProjectedContributionPerTicket, \'#\', 0)}}</div><div id="ctk-label" class="box-metric-label">Projected Contribution/Ticket ($)</div></div></div><div class="small-bump"></div><div class="row"><div class="col-md-4"><h2>Sales</h2><div class="row" ng-repeat="chart in salesCharts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div bar="" data="chart.breakdown" format="\'#\'" decimal="chart.decimal"></div></div></div></div><div class="col-md-4"><h2>Revenue</h2><div class="row" ng-repeat="chart in revenueCharts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div bar="" data="chart.breakdown" format="\'#\'" decimal="chart.decimal"></div></div></div></div><div class="col-md-4 adjust"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li></ul><div class="row" ng-repeat="chart in revenueChartsCont"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div bar="" data="chart.breakdown" format="\'#\'" decimal="chart.decimal"></div></div></div></div></div><div class="small-bump"></div><div class="row"><div class="col-md-4"><h2>Cost Estimate</h2><div class="row"><div class="col-md-12"><div class="info" ng-show="costCharts[0].info" data-toggle="popover" data-content="{{costCharts[0].info}}">i</div><h4>{{costCharts[0].title}}<span>&#40;{{costCharts[0].unit}}&#41;</span></h4><div bar="" data="costCharts[0].breakdown" format="\'#\'" decimal="chart.decimal"></div></div></div></div><div class="col-md-4"><h2>&nbsp;</h2><div class="row"><div class="col-md-12"><div class="info" ng-show="costCharts[1].info" data-toggle="popover" data-content="{{costCharts[1].info}}">i</div><h4>{{costCharts[1].title}}<span>&#40;{{costCharts[1].unit}}&#41;</span></h4><div bar="" data="costCharts[1].breakdown" format="\'#\'" decimal="chart.decimal"></div></div></div></div><div class="col-md-4"></div></div><div class="bump"></div></div></div>'),e.put("views/bookings/operations-event.html",'<div class="operations booking"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li ng-click="common.GoToPage(\'bookingsOperations\')">Operations Summary</li><li ng-click="common.GoToPage(\'bookingsOperationsVenue\')">Ancillary Revenue By Venue</li><li class="active" ng-click="common.GoToPage(\'bookingsOperationsEvent\')">Ancillary Revenue By Event Type</li><li ng-click="common.GoToPage(\'bookingsOperationsStaffing\')">Staffing</li><li class="disabled">Guest Satisfaction</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row" ng-repeat="chart in charts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format" decimal="chart.decimal"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format" decimal="chart.decimal"></div></div></div></div></div></div></div>'),
e.put("views/bookings/operations-staffing.html",'<div class="operations booking"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li ng-click="common.GoToPage(\'bookingsOperations\')">Operations Summary</li><li ng-click="common.GoToPage(\'bookingsOperationsVenue\')">Ancillary Revenue By Venue</li><li ng-click="common.GoToPage(\'bookingsOperationsEvent\')">Ancillary Revenue By Event Type</li><li class="active" ng-click="common.GoToPage(\'bookingsOperationsStaffing\')">Staffing</li><li class="disabled">Guest Satisfaction</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row" ng-repeat="chart in charts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format"></div><div class="front"><span></span> <span>Front of House</span> <span></span></div></div></div></div></div></div></div>'),e.put("views/bookings/operations-summary.html",'<div class="operations booking summary"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li class="active" ng-click="common.GoToPage(\'bookingsOperations\')">Operations Summary</li><li ng-click="common.GoToPage(\'bookingsOperationsVenue\')">Ancillary Revenue By Venue</li><li ng-click="common.GoToPage(\'bookingsOperationsEvent\')">Ancillary Revenue By Event Type</li><li ng-click="common.GoToPage(\'bookingsOperationsStaffing\')">Staffing</li><li class="disabled">Guest Satisfaction</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row"><div class="col-md-6"><h1>{{charts[0].title}}</h1><div ng-repeat="graph in charts[0].graphs"><div class="info infodash" ng-show="graph.info" data-toggle="popover" data-content="{{graph.info}}">i</div><h4>{{graph.title}} <span>&#40;{{graph.unit}}&#41;</span></h4><div bar="" data="graph.breakdown" format="graph.format" decimal="graph.decimal"></div></div><div class="clear"></div><h1>{{charts[1].title}}</h1><div ng-repeat="graph in charts[1].graphs"><div class="info infodash" ng-show="graph.info" data-toggle="popover" data-content="{{graph.info}}">i</div><h4>{{graph.title}} <span>&#40;{{graph.unit}}&#41;</span></h4><div bar="" data="graph.breakdown" format="graph.format"></div></div><div class="clear"></div></div><div class="col-md-6"><h1>{{charts[2].title}}</h1><div ng-repeat="graph in charts[2].graphs"><div class="row"><div class="col-md-4"><h4>{{graph.title}}</h4></div><div class="col-md-8"><div bar="" data="graph.breakdown" format="graph.format"></div></div></div></div><div class="clear"></div></div></div></div></div></div>'),e.put("views/bookings/operations-venue.html",'<div class="operations booking"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li ng-click="common.GoToPage(\'bookingsOperations\')">Operations Summary</li><li class="active" ng-click="common.GoToPage(\'bookingsOperationsVenue\')">Ancillary Revenue By Venue</li><li ng-click="common.GoToPage(\'bookingsOperationsEvent\')">Ancillary Revenue By Event Type</li><li ng-click="common.GoToPage(\'bookingsOperationsStaffing\')">Staffing</li><li class="disabled">Guest Satisfaction</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row" ng-repeat="chart in charts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format" decimal="chart.decimal"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format" decimal="chart.decimal"></div></div></div></div></div></div></div>'),e.put("views/bookings/tickets-both.html",'<div class="tickets"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li class="active" ng-click="common.GoToPage(\'bookingsTickets\')">Ticket Sales by Venue &amp; Event Type</li><li ng-click="common.GoToPage(\'bookingsTicketsVenue\')">Ticket Sales by Venue</li><li ng-click="common.GoToPage(\'bookingsTicketsEvent\')">Ticket Sales by Event Type</li><li ng-click="common.GoToPage(\'bookingsTicketsSponsorships\')">Event-Specific Sponsorship</li></ul></div></div><div class="row"><div class="col-md-12"><h2>{{$root.heatmap.title}}</h2><ul class="legend-performing pull-right"><li><span></span>High performing</li><li><span></span>Within range</li><li><span></span>Low performing</li></ul><div class="row"><div class="col-md-8"><div class="heatContainer" heatmap="" data="heat.chartData" ycats="heat.ycats" xcats="heat.xcats" format="$root.heatmap.format"></div></div><div class="col-md-4"><div class="eventlist"><div class="count" style="background-color: {{color}}">{{common.format(count, \'#\', 0)}}</div><div class="name">{{eventType}} @ {{venue}}</div><div class="events"><ul class="title"><li>Event</li><li>Date</li><li>{{$root.heatmap.header}}</li></ul><div style="height: {{height}}"><ul ng-repeat="event in events" ng-click="goToDetail(event)"><li>{{event.EventName}}</li><li>{{common.formatDate(event.Date, true)}}</li><li>{{getData(event)}}</li></ul></div></div></div></div></div></div></div></div></div></div>'),e.put("views/bookings/tickets-event.html",'<div class="tickets booking"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li ng-click="common.GoToPage(\'bookingsTickets\')">Ticket Sales by Venue &amp; Event Type</li><li ng-click="common.GoToPage(\'bookingsTicketsVenue\')">Ticket Sales by Venue</li><li class="active" ng-click="common.GoToPage(\'bookingsTicketsEvent\')">Ticket Sales by Event Type</li><li ng-click="common.GoToPage(\'bookingsTicketsSponsorships\')">Event-Specific Sponsorship</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row" ng-repeat="chart in charts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format" decimal="chart.decimal"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format" decimal="chart.decimal"></div></div></div></div></div></div></div>'),e.put("views/bookings/tickets-sponsorships.html",'<div class="tickets booking"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li ng-click="common.GoToPage(\'bookingsTickets\')">Ticket Sales by Venue &amp; Event Type</li><li ng-click="common.GoToPage(\'bookingsTicketsVenue\')">Ticket Sales by Venue</li><li ng-click="common.GoToPage(\'bookingsTicketsEvent\')">Ticket Sales by Event Type</li><li class="active" ng-click="common.GoToPage(\'bookingsTicketsSponsorships\')">Event-Specific Sponsorship</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row"><div class="col-md-12"><h4>Sponsorship Revenues<span>&#40;$&#41;</span></h4><div class="col-md-2"><div column="" data="sponsor.chartRevenue.total" format="\'#\'"></div></div><div class="col-md-10"><div column="" data="sponsor.chartRevenue.breakdown" format="\'#\'"></div></div></div></div><div class="row"><div class="col-md-12 mix"><h4>Sponsorship Revenue Mix<span>&#40;$&#41;</span></h4><ul class="legend-mix pie pull-right"><li><span></span>Contracted</li><li><span></span>Renewals</li><li><span></span>New business</li></ul></div></div><div class="row pie"><div class="col-md-4"><div pie="" data="sponsor.pieDataActual" format="\'#\'"></div><span>Actual</span></div><div class="col-md-4"><div pie="" data="sponsor.pieDataBudget" format="\'#\'"></div><span>Budget</span></div><div class="col-md-4"><div pie="" data="sponsor.pieDataPrior" format="\'#\'"></div><span>Previous Year</span></div></div><div class="row"><div class="col-md-12"><h4>Sponsors <span>&#40;Count&#41;</span></h4><div bar="" data="sponsor.chartSponsors" format="\'#\'" decimal="0"></div></div></div><div class="row"><div class="col-md-12"><h4>Average Deal Size <span>&#40;$&#41;</span></h4><div bar="" data="sponsor.chartDeal" format="\'#\'"></div></div></div><div class="bump"></div></div></div></div>'),e.put("views/bookings/tickets-venue.html",'<div class="tickets booking"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 sep"><ul class="tabs"><li ng-click="common.GoToPage(\'bookingsTickets\')">Ticket Sales by Venue &amp; Event Type</li><li class="active" ng-click="common.GoToPage(\'bookingsTicketsVenue\')">Ticket Sales by Venue</li><li ng-click="common.GoToPage(\'bookingsTicketsEvent\')">Ticket Sales by Event Type</li><li ng-click="common.GoToPage(\'bookingsTicketsSponsorships\')">Event-Specific Sponsorship</li></ul></div></div><div class="row"><div class="col-md-12"><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row" ng-repeat="chart in charts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format" decimal="chart.decimal"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format" decimal="chart.decimal"></div></div></div></div></div></div></div>'),e.put("views/productions/calendar-template.html",'<div class="daysOfSeason"><div class="dayTileDetail" ng-click="closeTileDetail($event)" ng-style="{display: (detailDay.show), left:(detailDay.xPosition + \'px\'), top:(detailDay.yPosition + \'px\')}"><span class="dayOfWeek">{{detailDay.dayOfWeek}}</span> <span class="dayOfMonth">{{detailDay.dayOfMonth}}</span> <span class="shows"><span class="show" ng-repeat="show in detailDay.events" ng-class="show.PerformanceCode" ng-click="goToFilteredCalendar(show, \'productionsTicketsChannel\')"><span class="time-slot">{{show.TimeSlot}}</span> <span class="sell-through" ng-class="show.PerformanceCode">{{show.SellThrough * 100 | currency:"":0}}%</span> <span class="grade">{{show.Grade}}</span></span></span></div><div class="week" ng-repeat="week in calendar"><div class="dayTile" ng-class="day.dayOfWeek" ng-click="showTileDetail(day, $event)" ng-repeat="day in week"><span class="dayOfWeek">{{day.dayOfWeek}}</span> <span class="dayOfMonth">{{day.dayOfMonth}}</span> <span class="shows"><span class="show" ng-repeat="show in day.events">{{show.TimeSlot}} <span class="performanceCode" ng-class="show.PerformanceCode">&nbsp;</span></span></span></div></div></div><div id="summaries"><div class="summary" ng-repeat="summary in summaries" ng-class="summary.PerformanceCode"><h3>Weekly Summary</h3><table><tr><td>TKT REV</td><td>{{summary.Revenue | currency:"$":0}}</td></tr><tr><td>Sell-Thru</td><td ng-show="summary.SellThrough > 0">{{summary.SellThrough * 100 | currency:"":0}}%</td></tr><tr><td>Tkts Sold</td><td>{{summary.Sold | currency:"":0}}</td></tr><tr><td>Tkt Yield</td><td>{{summary.RevenuePerCap | currency:"$":0}}</td></tr></table></div></div>'),e.put("views/productions/calendar.html",'<div id="calendar"><div class="container calendar-view"><div><span class="seasonRange" ng-show="calendarStart !=\'\'">{{calendarStart}} &#45; {{calendarEnd}}</span>&nbsp;<popover-dir class="infocalendar" info="An individual show’s sell-through rate is displayed by clicking into a specific show on the calendar"></popover-dir></div><ul class="legend pull-right"><popover-dir class="infocalendar" info="“Outperforming” performances have revenues above the budget for the performance. “Within range” indicates a performance’s revenues are at or above the revenues for the equivalent performance last year as of this date. “Underperforming” performances have revenues that are at least 75% of the revenues for the equivalent performance last year as of this date, but that are below last year’s revenues. “At risk” performances have revenue that is less than 75% of the revenue for the equivalent performance last year as of this date"></popover-dir><li><span></span>Outperforming</li><li><span></span>Within Range</li><li><span></span>Underperforming</li><li><span class="at-risk"></span>At Risk</li></ul><msg-calendar module="productions" placement="calendar-page"></msg-calendar></div></div>'),e.put("views/productions/dashboard.html",'<div class="dashboard"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12 location-legend"><popover-dir class="infocalendar" info="Previous year values are the value of a metric, as of today’s date last year, for a show’s previous year equivalent show. Each show has been assigned an equivalent show in the previous year (e.g. 9AM on Dec 2nd 2015 = 9AM on Dec. 1st 2014). It can be used to get a sense of “pacing” and if a show this year is “where it should be” based on last year’s performance"></popover-dir><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row"><div class="col-md-6" ng-repeat="chart in charts"><h1 ng-click="common.GoToPage(chart.url)">{{chart.title}} &gt;</h1><div ng-repeat="graph in chart.graphs"><div class="info infodash" ng-show="graph.info" data-toggle="popover" data-content="{{graph.info}}">i</div><div ng-click="common.GoToPage(chart.url)"><h4>{{graph.title}} <span>&#40;{{graph.unit}}&#41;</span></h4><div bar="" data="graph.breakdown" format="graph.format" decimal="graph.decimal"></div></div></div></div><div class="col-md-6"><div class="col-md-6 customer_s-bar"></div></div></div></div></div><div id="calendar"><div class="container calendar-view"><h1>Upcoming Performances <span ng-click="common.GoToPage(\'productionsCalendar\')">Full calendar ></span></h1><popover-dir class="infoPerformance" info="An individual show’s sell-through rate is displayed by clicking into a specific show on the calendar"></popover-dir><ul class="legend pull-right"><popover-dir class="infocalendar" info="“Outperforming” performances have revenues above the budget for the performance. “Within range” indicates a performance’s revenues are at or above the revenues for the equivalent performance last year as of this date. “Underperforming” performances have revenues that are at least 75% of the revenues for the equivalent performance last year as of this date, but that are below last year’s revenues. “At risk” performances have revenue that is less than 75% of the revenue for the equivalent performance last year as of this date"></popover-dir><li><span></span>Outperforming</li><li><span></span>Within Range</li><li><span></span>Underperforming</li><li><span class="at-risk"></span>At Risk</li></ul><msg-calendar module="productions" placement="dashboard-page"></msg-calendar></div></div></div>'),e.put("views/productions/operations-ancillary.html",'<div class="tickets"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12"><ul class="tabs"><li class="active" ng-click="common.GoToPage(\'productionsOperationsAncillary\')">Ancillary</li><li ng-click="common.GoToPage(\'productionsOperationsStaffing\')">Staffing</li><li class="disabled">Customer Satisfaction</li></ul><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row" ng-repeat="chart in charts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format" decimal="chart.decimal"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format" decimal="chart.decimal"></div></div></div></div></div></div></div>'),e.put("views/productions/operations-staffing.html",'<div class="tickets"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12"><ul class="tabs"><li ng-click="common.GoToPage(\'productionsOperationsAncillary\')">Ancillary</li><li class="active" ng-click="common.GoToPage(\'productionsOperationsStaffing\')">Staffing</li><li class="disabled">Customer Satisfaction</li></ul><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row" ng-repeat="chart in charts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format"></div></div></div></div></div></div></div>'),e.put("views/productions/tickets-channel.html",'<div class="tickets"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12"><ul class="tabs"><li class="active" ng-click="common.GoToPage(\'productionsTicketsChannel\')">Ticket Sales by Channel</li><li ng-click="common.GoToPage(\'productionsTicketsGrade\')">Ticket Sales by Show Grade</li><li ng-click="common.GoToPage(\'productionsTicketsSponsorships\')">Sponsorships</li></ul><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row" ng-repeat="chart in charts"><div class="col-md-12" ng-class="{red: chart.data===\'DiscountToFace\'}"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format" decimal="chart.decimal"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format" decimal="chart.decimal" border="true"></div></div></div></div><div class="row" ng-repeat="chart in mixCharts"><div class="col-md-12 mix"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><ul class="legend-mix pull-right"><li><span></span>Individual Full Price</li><li><span></span>Individual Discount</li><li><span></span>Flash</li><li><span></span>Non-Broker Groups</li><li><span></span>Brokers</li></ul><div stacked="" data="chart.breakdown" format="chart.format"></div></div></div><div class="row" ng-repeat="chart in barCharts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div bar="" data="chart.breakdown" format="chart.format"></div></div></div><div class="bump"></div></div></div></div>'),e.put("views/productions/tickets-grade.html",'<div class="tickets"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12"><ul class="tabs"><li ng-click="common.GoToPage(\'productionsTicketsChannel\')">Ticket Sales by Channel</li><li class="active" ng-click="common.GoToPage(\'productionsTicketsGrade\')">Ticket Sales by Show Grade</li><li ng-click="common.GoToPage(\'productionsTicketsSponsorships\')">Sponsorships</li></ul><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row" ng-repeat="chart in charts"><div class="col-md-12"><div class="info" ng-show="chart.info" data-toggle="popover" data-content="{{chart.info}}">i</div><h4>{{chart.title}}<span>&#40;{{chart.unit}}&#41;</span></h4><div class="col-md-2"><div column="" data="chart.total" format="chart.format" decimal="chart.decimal"></div></div><div class="col-md-10"><div column="" data="chart.breakdown" format="chart.format" decimal="chart.decimal"></div></div></div></div></div></div></div>'),e.put("views/productions/tickets-sponsorships.html",'<div class="tickets"><div class="container-fluid main"><div class="container"><div class="row"><div class="col-md-12"><ul class="tabs"><li ng-click="common.GoToPage(\'productionsTicketsChannel\')">Ticket Sales by Channel</li><li ng-click="common.GoToPage(\'productionsTicketsGrade\')">Ticket Sales by Show Grade</li><li class="active" ng-click="common.GoToPage(\'productionsTicketsSponsorships\')">Sponsorships</li></ul><ul class="legend pull-right"><li><span></span>Actual</li><li><span></span>Budget</li><li><span></span>Previous year</li></ul></div></div><div class="row"><div class="col-md-12"><h4>Sponsorship Revenues<span>&#40;$&#41;</span></h4><div class="col-md-2"><div column="" data="sponsor.revenueTotal" format="\'#\'"></div></div><div class="col-md-10"><div column="" data="sponsor.revenueBreakdown" format="\'#\'"></div></div></div></div><div class="row"><div class="col-md-12 mix"><popover-dir info="Represents number of staff per day (a full crew), not number of staff per show. Prior year labor data is currently unavailable"></popover-dir><h4>Sponsorship Revenue Mix<span>&#40;$&#41;</span></h4><ul class="legend-mix pie pull-right"><li><span></span>Contracted</li><li><span></span>Renewals</li><li><span></span>New business</li></ul></div></div><div class="row pie"><div class="col-md-4"><div pie="" data="sponsor.pieDataActual" format="\'#\'"></div><span>Actual</span></div><div class="col-md-4"><div pie="" data="sponsor.pieDataBudget" format="\'#\'"></div><span>Budget</span></div><div class="col-md-4"><div pie="" data="sponsor.pieDataPrior" format="\'#\'"></div><span>Previous Year</span></div></div><div class="row"><div class="col-md-12"><h4>Sponsors <span>&#40;Count&#41;</span></h4><div bar="" data="sponsor.sponsors" format="\'#\'" decimal="0"></div></div></div><div class="row"><div class="col-md-12"><h4>Average Deal Size <span>&#40;$&#41;</span></h4><div bar="" data="sponsor.dealSize" format="\'#\'"></div></div></div><div class="bump"></div></div></div></div>')}]);